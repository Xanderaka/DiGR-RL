Running training on CPU
Loading dataset train
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Loading dataset validation
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Building models...
Completed model building. Took 0.17 s.
                                                                                                                                                                     
Preparation complete. Starting training...
Training model...
{'epoch': 0, 'batch': 0, 'train_loss': 1.839, 'train_elbo_loss': 0.497, 'train_null_loss': 1.839, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.801, 'train_elbo_loss': 0.455, 'train_null_loss': 1.801, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.825, 'train_elbo_loss': 0.412, 'train_null_loss': 1.825, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 3, 'train_loss': 1.877, 'train_elbo_loss': 0.375, 'train_null_loss': 1.877, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 4, 'train_loss': 1.813, 'train_elbo_loss': 0.342, 'train_null_loss': 1.813, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 5, 'train_loss': 1.79, 'train_elbo_loss': 0.311, 'train_null_loss': 1.79, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.263, 'loss_diff': 0.0, 'epoch': 0, 'batch': 0}
{'valid_loss': 2.282, 'loss_diff': 0.0, 'epoch': 0, 'batch': 1}
{'valid_loss': 2.25, 'loss_diff': 0.0, 'epoch': 0, 'batch': 2}
{'valid_loss': 2.226, 'loss_diff': 0.0, 'epoch': 0, 'batch': 3}
{'valid_loss': 2.249, 'loss_diff': 0.0, 'epoch': 0, 'batch': 4}
{'valid_loss': 2.262, 'loss_diff': 0.0, 'epoch': 0, 'batch': 5}
{'valid_loss': 2.255, 'loss_diff': 0.0, 'epoch': 0, 'batch': 6}
Training model...
{'epoch': 1, 'batch': 0, 'train_loss': 1.876, 'train_elbo_loss': 0.28, 'train_null_loss': 1.876, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 1, 'train_loss': 1.826, 'train_elbo_loss': 0.261, 'train_null_loss': 1.826, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 2, 'train_loss': 1.848, 'train_elbo_loss': 0.238, 'train_null_loss': 1.848, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 3, 'train_loss': 1.853, 'train_elbo_loss': 0.221, 'train_null_loss': 1.853, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 4, 'train_loss': 1.827, 'train_elbo_loss': 0.208, 'train_null_loss': 1.827, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 5, 'train_loss': 1.806, 'train_elbo_loss': 0.183, 'train_null_loss': 1.806, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.211, 'loss_diff': 0.0, 'epoch': 1, 'batch': 0}
{'valid_loss': 2.211, 'loss_diff': 0.0, 'epoch': 1, 'batch': 1}
{'valid_loss': 2.163, 'loss_diff': 0.0, 'epoch': 1, 'batch': 2}
{'valid_loss': 2.153, 'loss_diff': 0.0, 'epoch': 1, 'batch': 3}
{'valid_loss': 2.212, 'loss_diff': 0.0, 'epoch': 1, 'batch': 4}
{'valid_loss': 2.267, 'loss_diff': 0.0, 'epoch': 1, 'batch': 5}
{'valid_loss': 2.203, 'loss_diff': 0.0, 'epoch': 1, 'batch': 6}
Training model...
{'epoch': 2, 'batch': 0, 'train_loss': 1.772, 'train_elbo_loss': 0.164, 'train_null_loss': 1.772, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 1, 'train_loss': 1.843, 'train_elbo_loss': 0.157, 'train_null_loss': 1.843, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 2, 'train_loss': 1.864, 'train_elbo_loss': 0.137, 'train_null_loss': 1.864, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 3, 'train_loss': 1.811, 'train_elbo_loss': 0.122, 'train_null_loss': 1.811, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 4, 'train_loss': 1.774, 'train_elbo_loss': 0.109, 'train_null_loss': 1.774, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 5, 'train_loss': 1.82, 'train_elbo_loss': 0.091, 'train_null_loss': 1.82, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.122, 'loss_diff': 0.0, 'epoch': 2, 'batch': 0}
{'valid_loss': 2.071, 'loss_diff': 0.0, 'epoch': 2, 'batch': 1}
{'valid_loss': 2.004, 'loss_diff': 0.0, 'epoch': 2, 'batch': 2}
{'valid_loss': 2.0, 'loss_diff': 0.0, 'epoch': 2, 'batch': 3}
{'valid_loss': 2.052, 'loss_diff': 0.0, 'epoch': 2, 'batch': 4}
{'valid_loss': 2.21, 'loss_diff': 0.0, 'epoch': 2, 'batch': 5}
{'valid_loss': 2.077, 'loss_diff': 0.0, 'epoch': 2, 'batch': 6}
Training model...
{'epoch': 3, 'batch': 0, 'train_loss': 1.779, 'train_elbo_loss': 0.088, 'train_null_loss': 1.779, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 1, 'train_loss': 1.694, 'train_elbo_loss': 0.075, 'train_null_loss': 1.694, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 2, 'train_loss': 1.874, 'train_elbo_loss': 0.061, 'train_null_loss': 1.874, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 3, 'train_loss': 1.743, 'train_elbo_loss': 0.069, 'train_null_loss': 1.743, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 4, 'train_loss': 1.732, 'train_elbo_loss': 0.06, 'train_null_loss': 1.732, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 5, 'train_loss': 1.718, 'train_elbo_loss': 0.054, 'train_null_loss': 1.718, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.871, 'loss_diff': 0.0, 'epoch': 3, 'batch': 0}
{'valid_loss': 1.901, 'loss_diff': 0.0, 'epoch': 3, 'batch': 1}
{'valid_loss': 1.809, 'loss_diff': 0.0, 'epoch': 3, 'batch': 2}
{'valid_loss': 1.769, 'loss_diff': 0.0, 'epoch': 3, 'batch': 3}
{'valid_loss': 1.97, 'loss_diff': 0.0, 'epoch': 3, 'batch': 4}
{'valid_loss': 2.021, 'loss_diff': 0.0, 'epoch': 3, 'batch': 5}
{'valid_loss': 1.911, 'loss_diff': 0.0, 'epoch': 3, 'batch': 6}
Training model...
{'epoch': 4, 'batch': 0, 'train_loss': 1.801, 'train_elbo_loss': 0.047, 'train_null_loss': 1.801, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 1, 'train_loss': 1.667, 'train_elbo_loss': 0.045, 'train_null_loss': 1.667, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 2, 'train_loss': 1.841, 'train_elbo_loss': 0.045, 'train_null_loss': 1.841, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 3, 'train_loss': 1.762, 'train_elbo_loss': 0.043, 'train_null_loss': 1.762, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 4, 'train_loss': 1.767, 'train_elbo_loss': 0.04, 'train_null_loss': 1.767, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 5, 'train_loss': 1.801, 'train_elbo_loss': 0.038, 'train_null_loss': 1.801, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.782, 'loss_diff': 0.0, 'epoch': 4, 'batch': 0}
{'valid_loss': 1.866, 'loss_diff': 0.0, 'epoch': 4, 'batch': 1}
{'valid_loss': 1.784, 'loss_diff': 0.0, 'epoch': 4, 'batch': 2}
{'valid_loss': 1.704, 'loss_diff': 0.0, 'epoch': 4, 'batch': 3}
{'valid_loss': 1.988, 'loss_diff': 0.0, 'epoch': 4, 'batch': 4}
{'valid_loss': 1.818, 'loss_diff': 0.0, 'epoch': 4, 'batch': 5}
{'valid_loss': 1.841, 'loss_diff': 0.0, 'epoch': 4, 'batch': 6}
Training model...
{'epoch': 5, 'batch': 0, 'train_loss': 1.667, 'train_elbo_loss': 0.036, 'train_null_loss': 1.667, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 1, 'train_loss': 1.741, 'train_elbo_loss': 0.036, 'train_null_loss': 1.741, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 2, 'train_loss': 1.667, 'train_elbo_loss': 0.03, 'train_null_loss': 1.667, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 3, 'train_loss': 1.686, 'train_elbo_loss': 0.031, 'train_null_loss': 1.686, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 4, 'train_loss': 1.684, 'train_elbo_loss': 0.031, 'train_null_loss': 1.684, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 5, 'train_loss': 1.764, 'train_elbo_loss': 0.031, 'train_null_loss': 1.764, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.853, 'loss_diff': 0.0, 'epoch': 5, 'batch': 0}
{'valid_loss': 1.839, 'loss_diff': 0.0, 'epoch': 5, 'batch': 1}
{'valid_loss': 1.699, 'loss_diff': 0.0, 'epoch': 5, 'batch': 2}
{'valid_loss': 1.585, 'loss_diff': 0.0, 'epoch': 5, 'batch': 3}
{'valid_loss': 1.99, 'loss_diff': 0.0, 'epoch': 5, 'batch': 4}
{'valid_loss': 1.709, 'loss_diff': 0.0, 'epoch': 5, 'batch': 5}
{'valid_loss': 1.806, 'loss_diff': 0.0, 'epoch': 5, 'batch': 6}
Training model...
{'epoch': 6, 'batch': 0, 'train_loss': 1.719, 'train_elbo_loss': 0.03, 'train_null_loss': 1.719, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 1, 'train_loss': 1.786, 'train_elbo_loss': 0.03, 'train_null_loss': 1.786, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 2, 'train_loss': 1.66, 'train_elbo_loss': 0.027, 'train_null_loss': 1.66, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 3, 'train_loss': 1.72, 'train_elbo_loss': 0.03, 'train_null_loss': 1.72, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 4, 'train_loss': 1.711, 'train_elbo_loss': 0.029, 'train_null_loss': 1.711, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 5, 'train_loss': 1.669, 'train_elbo_loss': 0.028, 'train_null_loss': 1.669, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.884, 'loss_diff': 0.0, 'epoch': 6, 'batch': 0}
{'valid_loss': 1.616, 'loss_diff': 0.0, 'epoch': 6, 'batch': 1}
{'valid_loss': 1.573, 'loss_diff': 0.0, 'epoch': 6, 'batch': 2}
{'valid_loss': 1.55, 'loss_diff': 0.0, 'epoch': 6, 'batch': 3}
{'valid_loss': 1.995, 'loss_diff': 0.0, 'epoch': 6, 'batch': 4}
{'valid_loss': 1.645, 'loss_diff': 0.0, 'epoch': 6, 'batch': 5}
{'valid_loss': 1.845, 'loss_diff': 0.0, 'epoch': 6, 'batch': 6}
Training model...
{'epoch': 7, 'batch': 0, 'train_loss': 1.722, 'train_elbo_loss': 0.026, 'train_null_loss': 1.722, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 1, 'train_loss': 1.755, 'train_elbo_loss': 0.028, 'train_null_loss': 1.755, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 2, 'train_loss': 1.671, 'train_elbo_loss': 0.025, 'train_null_loss': 1.671, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 3, 'train_loss': 1.813, 'train_elbo_loss': 0.026, 'train_null_loss': 1.813, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 4, 'train_loss': 1.754, 'train_elbo_loss': 0.026, 'train_null_loss': 1.754, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 5, 'train_loss': 1.605, 'train_elbo_loss': 0.025, 'train_null_loss': 1.605, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.841, 'loss_diff': 0.0, 'epoch': 7, 'batch': 0}
{'valid_loss': 1.586, 'loss_diff': 0.0, 'epoch': 7, 'batch': 1}
{'valid_loss': 1.549, 'loss_diff': 0.0, 'epoch': 7, 'batch': 2}
{'valid_loss': 1.522, 'loss_diff': 0.0, 'epoch': 7, 'batch': 3}
{'valid_loss': 1.968, 'loss_diff': 0.0, 'epoch': 7, 'batch': 4}
{'valid_loss': 1.636, 'loss_diff': 0.0, 'epoch': 7, 'batch': 5}
{'valid_loss': 1.842, 'loss_diff': 0.0, 'epoch': 7, 'batch': 6}
Training model...
{'epoch': 8, 'batch': 0, 'train_loss': 1.709, 'train_elbo_loss': 0.024, 'train_null_loss': 1.709, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 1, 'train_loss': 1.628, 'train_elbo_loss': 0.025, 'train_null_loss': 1.628, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 2, 'train_loss': 1.727, 'train_elbo_loss': 0.025, 'train_null_loss': 1.727, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 3, 'train_loss': 1.614, 'train_elbo_loss': 0.024, 'train_null_loss': 1.614, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 4, 'train_loss': 1.74, 'train_elbo_loss': 0.025, 'train_null_loss': 1.74, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 5, 'train_loss': 1.649, 'train_elbo_loss': 0.023, 'train_null_loss': 1.649, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.782, 'loss_diff': 0.0, 'epoch': 8, 'batch': 0}
{'valid_loss': 1.803, 'loss_diff': 0.0, 'epoch': 8, 'batch': 1}
{'valid_loss': 1.653, 'loss_diff': 0.0, 'epoch': 8, 'batch': 2}
{'valid_loss': 1.504, 'loss_diff': 0.0, 'epoch': 8, 'batch': 3}
{'valid_loss': 1.939, 'loss_diff': 0.0, 'epoch': 8, 'batch': 4}
{'valid_loss': 1.695, 'loss_diff': 0.0, 'epoch': 8, 'batch': 5}
{'valid_loss': 1.819, 'loss_diff': 0.0, 'epoch': 8, 'batch': 6}
Training model...
{'epoch': 9, 'batch': 0, 'train_loss': 1.704, 'train_elbo_loss': 0.025, 'train_null_loss': 1.704, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 1, 'train_loss': 1.664, 'train_elbo_loss': 0.024, 'train_null_loss': 1.664, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 2, 'train_loss': 1.66, 'train_elbo_loss': 0.023, 'train_null_loss': 1.66, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 3, 'train_loss': 1.614, 'train_elbo_loss': 0.024, 'train_null_loss': 1.614, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 4, 'train_loss': 1.621, 'train_elbo_loss': 0.021, 'train_null_loss': 1.621, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 5, 'train_loss': 1.767, 'train_elbo_loss': 0.023, 'train_null_loss': 1.767, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.703, 'loss_diff': 0.0, 'epoch': 9, 'batch': 0}
{'valid_loss': 1.726, 'loss_diff': 0.0, 'epoch': 9, 'batch': 1}
{'valid_loss': 1.696, 'loss_diff': 0.0, 'epoch': 9, 'batch': 2}
{'valid_loss': 1.613, 'loss_diff': 0.0, 'epoch': 9, 'batch': 3}
{'valid_loss': 1.949, 'loss_diff': 0.0, 'epoch': 9, 'batch': 4}
{'valid_loss': 1.714, 'loss_diff': 0.0, 'epoch': 9, 'batch': 5}
{'valid_loss': 1.803, 'loss_diff': 0.0, 'epoch': 9, 'batch': 6}
Training model...
{'epoch': 10, 'batch': 0, 'train_loss': 1.716, 'train_elbo_loss': 0.023, 'train_null_loss': 1.716, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 1, 'train_loss': 1.604, 'train_elbo_loss': 0.022, 'train_null_loss': 1.604, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 2, 'train_loss': 1.749, 'train_elbo_loss': 0.022, 'train_null_loss': 1.749, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 3, 'train_loss': 1.787, 'train_elbo_loss': 0.024, 'train_null_loss': 1.787, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 4, 'train_loss': 1.618, 'train_elbo_loss': 0.021, 'train_null_loss': 1.618, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 5, 'train_loss': 1.717, 'train_elbo_loss': 0.023, 'train_null_loss': 1.717, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.772, 'loss_diff': 0.0, 'epoch': 10, 'batch': 0}
{'valid_loss': 1.626, 'loss_diff': 0.0, 'epoch': 10, 'batch': 1}
{'valid_loss': 1.682, 'loss_diff': 0.0, 'epoch': 10, 'batch': 2}
{'valid_loss': 1.691, 'loss_diff': 0.0, 'epoch': 10, 'batch': 3}
{'valid_loss': 1.963, 'loss_diff': 0.0, 'epoch': 10, 'batch': 4}
{'valid_loss': 1.74, 'loss_diff': 0.0, 'epoch': 10, 'batch': 5}
{'valid_loss': 1.793, 'loss_diff': 0.0, 'epoch': 10, 'batch': 6}
Training model...
{'epoch': 11, 'batch': 0, 'train_loss': 1.54, 'train_elbo_loss': 0.024, 'train_null_loss': 1.54, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 1, 'train_loss': 1.703, 'train_elbo_loss': 0.021, 'train_null_loss': 1.703, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 2, 'train_loss': 1.725, 'train_elbo_loss': 0.021, 'train_null_loss': 1.725, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 3, 'train_loss': 1.536, 'train_elbo_loss': 0.023, 'train_null_loss': 1.536, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 4, 'train_loss': 1.665, 'train_elbo_loss': 0.022, 'train_null_loss': 1.665, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 5, 'train_loss': 1.599, 'train_elbo_loss': 0.022, 'train_null_loss': 1.599, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.747, 'loss_diff': 0.0, 'epoch': 11, 'batch': 0}
{'valid_loss': 1.693, 'loss_diff': 0.0, 'epoch': 11, 'batch': 1}
{'valid_loss': 1.664, 'loss_diff': 0.0, 'epoch': 11, 'batch': 2}
{'valid_loss': 1.626, 'loss_diff': 0.0, 'epoch': 11, 'batch': 3}
{'valid_loss': 1.947, 'loss_diff': 0.0, 'epoch': 11, 'batch': 4}
{'valid_loss': 1.721, 'loss_diff': 0.0, 'epoch': 11, 'batch': 5}
{'valid_loss': 1.829, 'loss_diff': 0.0, 'epoch': 11, 'batch': 6}
Training model...
{'epoch': 12, 'batch': 0, 'train_loss': 1.702, 'train_elbo_loss': 0.022, 'train_null_loss': 1.702, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 1, 'train_loss': 1.746, 'train_elbo_loss': 0.02, 'train_null_loss': 1.746, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 2, 'train_loss': 1.684, 'train_elbo_loss': 0.021, 'train_null_loss': 1.684, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 3, 'train_loss': 1.709, 'train_elbo_loss': 0.019, 'train_null_loss': 1.709, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 4, 'train_loss': 1.617, 'train_elbo_loss': 0.021, 'train_null_loss': 1.617, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 5, 'train_loss': 1.632, 'train_elbo_loss': 0.022, 'train_null_loss': 1.632, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.809, 'loss_diff': 0.0, 'epoch': 12, 'batch': 0}
{'valid_loss': 1.569, 'loss_diff': 0.0, 'epoch': 12, 'batch': 1}
{'valid_loss': 1.605, 'loss_diff': 0.0, 'epoch': 12, 'batch': 2}
{'valid_loss': 1.689, 'loss_diff': 0.0, 'epoch': 12, 'batch': 3}
{'valid_loss': 1.98, 'loss_diff': 0.0, 'epoch': 12, 'batch': 4}
{'valid_loss': 1.732, 'loss_diff': 0.0, 'epoch': 12, 'batch': 5}
{'valid_loss': 1.753, 'loss_diff': 0.0, 'epoch': 12, 'batch': 6}
Training model...
{'epoch': 13, 'batch': 0, 'train_loss': 1.699, 'train_elbo_loss': 0.021, 'train_null_loss': 1.699, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 1, 'train_loss': 1.651, 'train_elbo_loss': 0.02, 'train_null_loss': 1.651, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 2, 'train_loss': 1.645, 'train_elbo_loss': 0.021, 'train_null_loss': 1.645, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 3, 'train_loss': 1.659, 'train_elbo_loss': 0.021, 'train_null_loss': 1.659, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 4, 'train_loss': 1.81, 'train_elbo_loss': 0.021, 'train_null_loss': 1.81, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 5, 'train_loss': 1.649, 'train_elbo_loss': 0.019, 'train_null_loss': 1.649, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.905, 'loss_diff': 0.0, 'epoch': 13, 'batch': 0}
{'valid_loss': 1.53, 'loss_diff': 0.0, 'epoch': 13, 'batch': 1}
{'valid_loss': 1.583, 'loss_diff': 0.0, 'epoch': 13, 'batch': 2}
{'valid_loss': 1.767, 'loss_diff': 0.0, 'epoch': 13, 'batch': 3}
{'valid_loss': 1.996, 'loss_diff': 0.0, 'epoch': 13, 'batch': 4}
{'valid_loss': 1.668, 'loss_diff': 0.0, 'epoch': 13, 'batch': 5}
{'valid_loss': 1.718, 'loss_diff': 0.0, 'epoch': 13, 'batch': 6}
Training model...
{'epoch': 14, 'batch': 0, 'train_loss': 1.793, 'train_elbo_loss': 0.02, 'train_null_loss': 1.793, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 1, 'train_loss': 1.634, 'train_elbo_loss': 0.021, 'train_null_loss': 1.634, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 2, 'train_loss': 1.661, 'train_elbo_loss': 0.019, 'train_null_loss': 1.661, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 3, 'train_loss': 1.597, 'train_elbo_loss': 0.019, 'train_null_loss': 1.597, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 4, 'train_loss': 1.586, 'train_elbo_loss': 0.018, 'train_null_loss': 1.586, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 5, 'train_loss': 1.615, 'train_elbo_loss': 0.021, 'train_null_loss': 1.615, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.711, 'loss_diff': 0.0, 'epoch': 14, 'batch': 0}
{'valid_loss': 1.75, 'loss_diff': 0.0, 'epoch': 14, 'batch': 1}
{'valid_loss': 1.739, 'loss_diff': 0.0, 'epoch': 14, 'batch': 2}
{'valid_loss': 1.77, 'loss_diff': 0.0, 'epoch': 14, 'batch': 3}
{'valid_loss': 1.943, 'loss_diff': 0.0, 'epoch': 14, 'batch': 4}
{'valid_loss': 1.687, 'loss_diff': 0.0, 'epoch': 14, 'batch': 5}
{'valid_loss': 1.748, 'loss_diff': 0.0, 'epoch': 14, 'batch': 6}
Training embedding agent starting this epoch...
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Training agent for 216 steps...
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 108      |
|    ep_rew_mean     | 0.0996   |
| time/              |          |
|    fps             | 27       |
|    iterations      | 1        |
|    time_elapsed    | 74       |
|    total_timesteps | 2048     |
---------------------------------
Training model...
{'epoch': 15, 'batch': 0, 'train_loss': 1.58, 'train_elbo_loss': 0.02, 'train_null_loss': 1.602, 'train_embed_loss': 1.558, 'train_loss_diff': -0.045}
{'epoch': 15, 'batch': 1, 'train_loss': 1.679, 'train_elbo_loss': 0.019, 'train_null_loss': 1.705, 'train_embed_loss': 1.653, 'train_loss_diff': -0.052}
{'epoch': 15, 'batch': 2, 'train_loss': 1.681, 'train_elbo_loss': 0.02, 'train_null_loss': 1.699, 'train_embed_loss': 1.663, 'train_loss_diff': -0.036}
{'epoch': 15, 'batch': 3, 'train_loss': 1.646, 'train_elbo_loss': 0.019, 'train_null_loss': 1.657, 'train_embed_loss': 1.634, 'train_loss_diff': -0.023}
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 219, in <module>
    run_training(parse_config_file(args.CONFIG_FP))
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 206, in run_training
    training.train(
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 553, in train
    if not self._train_vae(train_loader, device, epoch):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 218, in _train_vae
    for batch_idx, (amp, phase, bvp, info) in enumerate(train_loader):
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 708, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 764, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\data_utils\dataloader_collate.py", line 39, in widar_collate_fn
    infos[k].append(v)
    ~~~~~^^^
KeyError: 'episode'
