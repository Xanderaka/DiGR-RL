Running training on CPU
Loading dataset train
Found pregenerated data dir.
Loading complete. Took 0.01 s.
Loading dataset validation
Found pregenerated data dir.
Loading complete. Took 0.00 s.
Building models...
Completed model building. Took 8.95 s.
                                                                                                                                                                     
Preparation complete. Starting training...
Training model...
{'epoch': 0, 'batch': 0, 'train_loss': 1.871, 'train_domain_loss': 3.203, 'train_null_loss': 1.871, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.863, 'train_domain_loss': 3.23, 'train_null_loss': 1.863, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.768, 'train_domain_loss': 3.207, 'train_null_loss': 1.768, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 3, 'train_loss': 1.822, 'train_domain_loss': 3.228, 'train_null_loss': 1.822, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 4, 'train_loss': 1.804, 'train_domain_loss': 3.223, 'train_null_loss': 1.804, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 5, 'train_loss': 1.783, 'train_domain_loss': 3.21, 'train_null_loss': 1.783, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 6, 'train_loss': 1.852, 'train_domain_loss': 3.208, 'train_null_loss': 1.852, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 7, 'train_loss': 1.794, 'train_domain_loss': 3.227, 'train_null_loss': 1.794, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 8, 'train_loss': 1.695, 'train_domain_loss': 3.24, 'train_null_loss': 1.695, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 9, 'train_loss': 1.708, 'train_domain_loss': 3.218, 'train_null_loss': 1.708, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 10, 'train_loss': 1.827, 'train_domain_loss': 3.243, 'train_null_loss': 1.827, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 11, 'train_loss': 1.8, 'train_domain_loss': 3.223, 'train_null_loss': 1.8, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 12, 'train_loss': 1.724, 'train_domain_loss': 3.207, 'train_null_loss': 1.724, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 13, 'train_loss': 1.742, 'train_domain_loss': 3.221, 'train_null_loss': 1.742, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 14, 'train_loss': 1.745, 'train_domain_loss': 3.202, 'train_null_loss': 1.745, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 15, 'train_loss': 1.76, 'train_domain_loss': 3.231, 'train_null_loss': 1.76, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 16, 'train_loss': 1.741, 'train_domain_loss': 3.229, 'train_null_loss': 1.741, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 17, 'train_loss': 1.76, 'train_domain_loss': 3.241, 'train_null_loss': 1.76, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 18, 'train_loss': 1.812, 'train_domain_loss': 3.192, 'train_null_loss': 1.812, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 19, 'train_loss': 1.774, 'train_domain_loss': 3.223, 'train_null_loss': 1.774, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 20, 'train_loss': 1.827, 'train_domain_loss': 3.216, 'train_null_loss': 1.827, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 21, 'train_loss': 1.81, 'train_domain_loss': 3.242, 'train_null_loss': 1.81, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 22, 'train_loss': 1.74, 'train_domain_loss': 3.195, 'train_null_loss': 1.74, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 23, 'train_loss': 1.766, 'train_domain_loss': 3.222, 'train_null_loss': 1.766, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 24, 'train_loss': 1.803, 'train_domain_loss': 3.247, 'train_null_loss': 1.803, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 25, 'train_loss': 1.823, 'train_domain_loss': 3.251, 'train_null_loss': 1.823, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 26, 'train_loss': 1.795, 'train_domain_loss': 3.217, 'train_null_loss': 1.795, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 27, 'train_loss': 1.766, 'train_domain_loss': 3.241, 'train_null_loss': 1.766, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 28, 'train_loss': 1.789, 'train_domain_loss': 3.227, 'train_null_loss': 1.789, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 29, 'train_loss': 1.766, 'train_domain_loss': 3.215, 'train_null_loss': 1.766, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 30, 'train_loss': 1.75, 'train_domain_loss': 3.202, 'train_null_loss': 1.75, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 31, 'train_loss': 1.829, 'train_domain_loss': 3.226, 'train_null_loss': 1.829, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 32, 'train_loss': 1.771, 'train_domain_loss': 3.223, 'train_null_loss': 1.771, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 33, 'train_loss': 1.76, 'train_domain_loss': 3.213, 'train_null_loss': 1.76, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 34, 'train_loss': 1.77, 'train_domain_loss': 3.226, 'train_null_loss': 1.77, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 35, 'train_loss': 1.709, 'train_domain_loss': 3.234, 'train_null_loss': 1.709, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 36, 'train_loss': 1.688, 'train_domain_loss': 3.226, 'train_null_loss': 1.688, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 4.785, 'loss_diff': 0.0, 'epoch': 0, 'batch': 0}
{'valid_loss': 4.961, 'loss_diff': 0.0, 'epoch': 0, 'batch': 1}
{'valid_loss': 4.965, 'loss_diff': 0.0, 'epoch': 0, 'batch': 2}
{'valid_loss': 4.924, 'loss_diff': 0.0, 'epoch': 0, 'batch': 3}
{'valid_loss': 5.126, 'loss_diff': 0.0, 'epoch': 0, 'batch': 4}
{'valid_loss': 5.011, 'loss_diff': 0.0, 'epoch': 0, 'batch': 5}
{'valid_loss': 4.887, 'loss_diff': 0.0, 'epoch': 0, 'batch': 6}
Training model...
{'epoch': 1, 'batch': 0, 'train_loss': 1.734, 'train_domain_loss': 3.228, 'train_null_loss': 1.734, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 1, 'train_loss': 1.699, 'train_domain_loss': 3.229, 'train_null_loss': 1.699, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 2, 'train_loss': 1.721, 'train_domain_loss': 3.218, 'train_null_loss': 1.721, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 3, 'train_loss': 1.728, 'train_domain_loss': 3.21, 'train_null_loss': 1.728, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 4, 'train_loss': 1.684, 'train_domain_loss': 3.209, 'train_null_loss': 1.684, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 5, 'train_loss': 1.738, 'train_domain_loss': 3.249, 'train_null_loss': 1.738, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 6, 'train_loss': 1.728, 'train_domain_loss': 3.232, 'train_null_loss': 1.728, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 7, 'train_loss': 1.749, 'train_domain_loss': 3.227, 'train_null_loss': 1.749, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 8, 'train_loss': 1.741, 'train_domain_loss': 3.227, 'train_null_loss': 1.741, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 9, 'train_loss': 1.674, 'train_domain_loss': 3.229, 'train_null_loss': 1.674, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 10, 'train_loss': 1.739, 'train_domain_loss': 3.222, 'train_null_loss': 1.739, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 11, 'train_loss': 1.807, 'train_domain_loss': 3.217, 'train_null_loss': 1.807, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 12, 'train_loss': 1.731, 'train_domain_loss': 3.204, 'train_null_loss': 1.731, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 13, 'train_loss': 1.673, 'train_domain_loss': 3.22, 'train_null_loss': 1.673, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 14, 'train_loss': 1.667, 'train_domain_loss': 3.219, 'train_null_loss': 1.667, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 15, 'train_loss': 1.777, 'train_domain_loss': 3.224, 'train_null_loss': 1.777, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 16, 'train_loss': 1.706, 'train_domain_loss': 3.221, 'train_null_loss': 1.706, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 17, 'train_loss': 1.632, 'train_domain_loss': 3.222, 'train_null_loss': 1.632, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 18, 'train_loss': 1.722, 'train_domain_loss': 3.213, 'train_null_loss': 1.722, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 19, 'train_loss': 1.722, 'train_domain_loss': 3.191, 'train_null_loss': 1.722, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 20, 'train_loss': 1.726, 'train_domain_loss': 3.23, 'train_null_loss': 1.726, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 21, 'train_loss': 1.713, 'train_domain_loss': 3.214, 'train_null_loss': 1.713, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 22, 'train_loss': 1.723, 'train_domain_loss': 3.229, 'train_null_loss': 1.723, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 23, 'train_loss': 1.727, 'train_domain_loss': 3.232, 'train_null_loss': 1.727, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 24, 'train_loss': 1.759, 'train_domain_loss': 3.243, 'train_null_loss': 1.759, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 25, 'train_loss': 1.69, 'train_domain_loss': 3.201, 'train_null_loss': 1.69, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 26, 'train_loss': 1.786, 'train_domain_loss': 3.216, 'train_null_loss': 1.786, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 27, 'train_loss': 1.696, 'train_domain_loss': 3.213, 'train_null_loss': 1.696, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 28, 'train_loss': 1.741, 'train_domain_loss': 3.225, 'train_null_loss': 1.741, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 29, 'train_loss': 1.691, 'train_domain_loss': 3.216, 'train_null_loss': 1.691, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 30, 'train_loss': 1.727, 'train_domain_loss': 3.22, 'train_null_loss': 1.727, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 31, 'train_loss': 1.685, 'train_domain_loss': 3.214, 'train_null_loss': 1.685, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 32, 'train_loss': 1.768, 'train_domain_loss': 3.224, 'train_null_loss': 1.768, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 33, 'train_loss': 1.689, 'train_domain_loss': 3.23, 'train_null_loss': 1.689, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 34, 'train_loss': 1.659, 'train_domain_loss': 3.24, 'train_null_loss': 1.659, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 35, 'train_loss': 1.713, 'train_domain_loss': 3.217, 'train_null_loss': 1.713, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 36, 'train_loss': 1.777, 'train_domain_loss': 3.224, 'train_null_loss': 1.777, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 4.79, 'loss_diff': 0.0, 'epoch': 1, 'batch': 0}
{'valid_loss': 5.06, 'loss_diff': 0.0, 'epoch': 1, 'batch': 1}
{'valid_loss': 4.955, 'loss_diff': 0.0, 'epoch': 1, 'batch': 2}
{'valid_loss': 4.812, 'loss_diff': 0.0, 'epoch': 1, 'batch': 3}
{'valid_loss': 4.985, 'loss_diff': 0.0, 'epoch': 1, 'batch': 4}
{'valid_loss': 4.788, 'loss_diff': 0.0, 'epoch': 1, 'batch': 5}
{'valid_loss': 4.909, 'loss_diff': 0.0, 'epoch': 1, 'batch': 6}
Training model...
{'epoch': 2, 'batch': 0, 'train_loss': 1.782, 'train_domain_loss': 3.227, 'train_null_loss': 1.782, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 1, 'train_loss': 1.65, 'train_domain_loss': 3.224, 'train_null_loss': 1.65, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 2, 'train_loss': 1.699, 'train_domain_loss': 3.198, 'train_null_loss': 1.699, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 3, 'train_loss': 1.741, 'train_domain_loss': 3.217, 'train_null_loss': 1.741, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 4, 'train_loss': 1.658, 'train_domain_loss': 3.205, 'train_null_loss': 1.658, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 5, 'train_loss': 1.736, 'train_domain_loss': 3.201, 'train_null_loss': 1.736, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 6, 'train_loss': 1.653, 'train_domain_loss': 3.237, 'train_null_loss': 1.653, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 7, 'train_loss': 1.709, 'train_domain_loss': 3.224, 'train_null_loss': 1.709, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 8, 'train_loss': 1.707, 'train_domain_loss': 3.209, 'train_null_loss': 1.707, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 9, 'train_loss': 1.706, 'train_domain_loss': 3.223, 'train_null_loss': 1.706, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 10, 'train_loss': 1.844, 'train_domain_loss': 3.22, 'train_null_loss': 1.844, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 11, 'train_loss': 1.635, 'train_domain_loss': 3.2, 'train_null_loss': 1.635, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 12, 'train_loss': 1.721, 'train_domain_loss': 3.207, 'train_null_loss': 1.721, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 13, 'train_loss': 1.754, 'train_domain_loss': 3.223, 'train_null_loss': 1.754, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 14, 'train_loss': 1.695, 'train_domain_loss': 3.233, 'train_null_loss': 1.695, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 15, 'train_loss': 1.704, 'train_domain_loss': 3.218, 'train_null_loss': 1.704, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 16, 'train_loss': 1.651, 'train_domain_loss': 3.206, 'train_null_loss': 1.651, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 17, 'train_loss': 1.665, 'train_domain_loss': 3.221, 'train_null_loss': 1.665, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 18, 'train_loss': 1.731, 'train_domain_loss': 3.215, 'train_null_loss': 1.731, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 19, 'train_loss': 1.702, 'train_domain_loss': 3.225, 'train_null_loss': 1.702, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 20, 'train_loss': 1.698, 'train_domain_loss': 3.228, 'train_null_loss': 1.698, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 21, 'train_loss': 1.597, 'train_domain_loss': 3.212, 'train_null_loss': 1.597, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 22, 'train_loss': 1.659, 'train_domain_loss': 3.224, 'train_null_loss': 1.659, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 23, 'train_loss': 1.704, 'train_domain_loss': 3.223, 'train_null_loss': 1.704, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 24, 'train_loss': 1.706, 'train_domain_loss': 3.222, 'train_null_loss': 1.706, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 25, 'train_loss': 1.634, 'train_domain_loss': 3.256, 'train_null_loss': 1.634, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 26, 'train_loss': 1.699, 'train_domain_loss': 3.205, 'train_null_loss': 1.699, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 27, 'train_loss': 1.737, 'train_domain_loss': 3.234, 'train_null_loss': 1.737, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 28, 'train_loss': 1.732, 'train_domain_loss': 3.235, 'train_null_loss': 1.732, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 29, 'train_loss': 1.69, 'train_domain_loss': 3.229, 'train_null_loss': 1.69, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 30, 'train_loss': 1.673, 'train_domain_loss': 3.238, 'train_null_loss': 1.673, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 31, 'train_loss': 1.684, 'train_domain_loss': 3.217, 'train_null_loss': 1.684, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 32, 'train_loss': 1.679, 'train_domain_loss': 3.227, 'train_null_loss': 1.679, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 33, 'train_loss': 1.746, 'train_domain_loss': 3.244, 'train_null_loss': 1.746, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 34, 'train_loss': 1.787, 'train_domain_loss': 3.233, 'train_null_loss': 1.787, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 35, 'train_loss': 1.767, 'train_domain_loss': 3.198, 'train_null_loss': 1.767, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 36, 'train_loss': 1.73, 'train_domain_loss': 3.244, 'train_null_loss': 1.73, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 4.84, 'loss_diff': 0.0, 'epoch': 2, 'batch': 0}
{'valid_loss': 5.049, 'loss_diff': 0.0, 'epoch': 2, 'batch': 1}
{'valid_loss': 4.801, 'loss_diff': 0.0, 'epoch': 2, 'batch': 2}
{'valid_loss': 4.571, 'loss_diff': 0.0, 'epoch': 2, 'batch': 3}
{'valid_loss': 4.989, 'loss_diff': 0.0, 'epoch': 2, 'batch': 4}
{'valid_loss': 4.924, 'loss_diff': 0.0, 'epoch': 2, 'batch': 5}
{'valid_loss': 4.877, 'loss_diff': 0.0, 'epoch': 2, 'batch': 6}
Training embedding agent starting this epoch...
Training agent for 1200 steps...
Training model...
{'epoch': 3, 'batch': 0, 'train_loss': 1.679, 'train_domain_loss': 3.215, 'train_null_loss': 1.663, 'train_embed_loss': 1.696, 'train_loss_diff': 0.033}
{'epoch': 3, 'batch': 1, 'train_loss': 1.742, 'train_domain_loss': 3.229, 'train_null_loss': 1.726, 'train_embed_loss': 1.759, 'train_loss_diff': 0.032}
{'epoch': 3, 'batch': 2, 'train_loss': 1.641, 'train_domain_loss': 3.236, 'train_null_loss': 1.64, 'train_embed_loss': 1.641, 'train_loss_diff': 0.001}
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 225, in <module>
    best_loss = run_training(parse_config_file(args.CONFIG_FP))
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 211, in run_training
    best_loss = training.train(
        train_loader=train_dataloader,
    ...<3 lines>...
        agent_epochs=config["embed"]["epochs"]
    )
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 571, in train
    if not self._train_backbone(train_loader, device, epoch):
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 238, in _train_backbone
    pass_result = self._forward_pass(
        amp, phase, bvp, info["gesture"], info,
        device, no_grad_backbone=False, domain_label=domain_label
    )
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 177, in _forward_pass
    z = self.encoder(amp, phase, bvp)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\backbone\BackBoneArchitecture.py", line 67, in forward
    z_phase = self.phase_backbone(phase)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\backbone\ViT.py", line 71, in forward
    x = self.transformer(x)       # [B, N+1, base_channels]
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\backbone\ViT.py", line 34, in forward
    return self.transformer(x)  # [B, N+1, E]
           ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\transformer.py", line 514, in forward
    output = mod(
        output,
    ...<2 lines>...
        src_key_padding_mask=src_key_padding_mask_for_layers,
    )
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\transformer.py", line 916, in forward
    x = self.norm2(x + self._ff_block(x))
                       ~~~~~~~~~~~~~~^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\transformer.py", line 941, in _ff_block
    x = self.linear2(self.dropout(self.activation(self.linear1(x))))
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\fx\traceback.py", line 189, in format_stack
    return traceback.format_list(traceback.extract_stack()[:-1])
                                 ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\traceback.py", line 260, in extract_stack
    stack = StackSummary.extract(walk_stack(f), limit=limit)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\traceback.py", line 449, in extract
    return klass._extract_from_extended_frame_gen(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        extended_frame_gen(), limit=limit, lookup_lines=lookup_lines,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        capture_locals=capture_locals)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\traceback.py", line 495, in _extract_from_extended_frame_gen
    linecache.checkcache(filename)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\linecache.py", line 94, in checkcache
    stat = os.stat(fullname)
KeyboardInterrupt
