Running training on CPU
Loading dataset train
Found pregenerated data dir.
Loading complete. Took 0.02 s.
Loading dataset validation
Found pregenerated data dir.
Loading complete. Took 0.01 s.
Building models...
Completed model building. Took 36.06 s.
                                                                                                                                                                  
Preparation complete. Starting training...
Training model...
{'epoch': 0, 'batch': 0, 'train_loss': 1.748, 'train_domain_loss': 3.225, 'train_null_loss': 1.748, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.773, 'train_domain_loss': 3.234, 'train_null_loss': 1.773, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.837, 'train_domain_loss': 3.224, 'train_null_loss': 1.837, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 3, 'train_loss': 1.812, 'train_domain_loss': 3.228, 'train_null_loss': 1.812, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 4, 'train_loss': 1.793, 'train_domain_loss': 3.234, 'train_null_loss': 1.793, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 5, 'train_loss': 1.838, 'train_domain_loss': 3.204, 'train_null_loss': 1.838, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 6, 'train_loss': 1.821, 'train_domain_loss': 3.203, 'train_null_loss': 1.821, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 7, 'train_loss': 1.755, 'train_domain_loss': 3.233, 'train_null_loss': 1.755, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 8, 'train_loss': 1.779, 'train_domain_loss': 3.252, 'train_null_loss': 1.779, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 9, 'train_loss': 1.745, 'train_domain_loss': 3.223, 'train_null_loss': 1.745, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 10, 'train_loss': 1.741, 'train_domain_loss': 3.232, 'train_null_loss': 1.741, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 11, 'train_loss': 1.764, 'train_domain_loss': 3.224, 'train_null_loss': 1.764, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 12, 'train_loss': 1.757, 'train_domain_loss': 3.226, 'train_null_loss': 1.757, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 13, 'train_loss': 1.748, 'train_domain_loss': 3.225, 'train_null_loss': 1.748, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 14, 'train_loss': 1.627, 'train_domain_loss': 3.202, 'train_null_loss': 1.627, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 15, 'train_loss': 1.716, 'train_domain_loss': 3.22, 'train_null_loss': 1.716, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 16, 'train_loss': 1.753, 'train_domain_loss': 3.216, 'train_null_loss': 1.753, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 17, 'train_loss': 1.749, 'train_domain_loss': 3.213, 'train_null_loss': 1.749, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 5.272, 'loss_diff': 0.0, 'epoch': 0, 'batch': 0}
{'valid_loss': 4.713, 'loss_diff': 0.0, 'epoch': 0, 'batch': 1}
{'valid_loss': 5.161, 'loss_diff': 0.0, 'epoch': 0, 'batch': 2}
Training model...
{'epoch': 1, 'batch': 0, 'train_loss': 1.749, 'train_domain_loss': 3.219, 'train_null_loss': 1.749, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 1, 'train_loss': 1.753, 'train_domain_loss': 3.217, 'train_null_loss': 1.753, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 2, 'train_loss': 1.679, 'train_domain_loss': 3.225, 'train_null_loss': 1.679, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 3, 'train_loss': 1.726, 'train_domain_loss': 3.217, 'train_null_loss': 1.726, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 4, 'train_loss': 1.695, 'train_domain_loss': 3.217, 'train_null_loss': 1.695, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 5, 'train_loss': 1.763, 'train_domain_loss': 3.201, 'train_null_loss': 1.763, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 6, 'train_loss': 1.711, 'train_domain_loss': 3.225, 'train_null_loss': 1.711, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 7, 'train_loss': 1.663, 'train_domain_loss': 3.221, 'train_null_loss': 1.663, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 8, 'train_loss': 1.714, 'train_domain_loss': 3.236, 'train_null_loss': 1.714, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 9, 'train_loss': 1.713, 'train_domain_loss': 3.213, 'train_null_loss': 1.713, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 10, 'train_loss': 1.681, 'train_domain_loss': 3.217, 'train_null_loss': 1.681, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 11, 'train_loss': 1.737, 'train_domain_loss': 3.224, 'train_null_loss': 1.737, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 12, 'train_loss': 1.737, 'train_domain_loss': 3.223, 'train_null_loss': 1.737, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 13, 'train_loss': 1.669, 'train_domain_loss': 3.201, 'train_null_loss': 1.669, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 14, 'train_loss': 1.634, 'train_domain_loss': 3.228, 'train_null_loss': 1.634, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 15, 'train_loss': 1.678, 'train_domain_loss': 3.209, 'train_null_loss': 1.678, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 16, 'train_loss': 1.695, 'train_domain_loss': 3.206, 'train_null_loss': 1.695, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 17, 'train_loss': 1.707, 'train_domain_loss': 3.213, 'train_null_loss': 1.707, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 5.146, 'loss_diff': 0.0, 'epoch': 1, 'batch': 0}
{'valid_loss': 4.668, 'loss_diff': 0.0, 'epoch': 1, 'batch': 1}
{'valid_loss': 5.032, 'loss_diff': 0.0, 'epoch': 1, 'batch': 2}
Training model...
{'epoch': 2, 'batch': 0, 'train_loss': 1.697, 'train_domain_loss': 3.222, 'train_null_loss': 1.697, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 1, 'train_loss': 1.663, 'train_domain_loss': 3.216, 'train_null_loss': 1.663, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 2, 'train_loss': 1.694, 'train_domain_loss': 3.208, 'train_null_loss': 1.694, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 3, 'train_loss': 1.688, 'train_domain_loss': 3.21, 'train_null_loss': 1.688, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 4, 'train_loss': 1.641, 'train_domain_loss': 3.215, 'train_null_loss': 1.641, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 5, 'train_loss': 1.69, 'train_domain_loss': 3.205, 'train_null_loss': 1.69, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 6, 'train_loss': 1.713, 'train_domain_loss': 3.223, 'train_null_loss': 1.713, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 7, 'train_loss': 1.632, 'train_domain_loss': 3.218, 'train_null_loss': 1.632, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 8, 'train_loss': 1.684, 'train_domain_loss': 3.204, 'train_null_loss': 1.684, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 9, 'train_loss': 1.712, 'train_domain_loss': 3.2, 'train_null_loss': 1.712, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 10, 'train_loss': 1.754, 'train_domain_loss': 3.195, 'train_null_loss': 1.754, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 11, 'train_loss': 1.78, 'train_domain_loss': 3.193, 'train_null_loss': 1.78, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 12, 'train_loss': 1.652, 'train_domain_loss': 3.194, 'train_null_loss': 1.652, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 13, 'train_loss': 1.675, 'train_domain_loss': 3.197, 'train_null_loss': 1.675, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 14, 'train_loss': 1.731, 'train_domain_loss': 3.204, 'train_null_loss': 1.731, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 15, 'train_loss': 1.708, 'train_domain_loss': 3.179, 'train_null_loss': 1.708, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 16, 'train_loss': 1.694, 'train_domain_loss': 3.201, 'train_null_loss': 1.694, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 17, 'train_loss': 1.656, 'train_domain_loss': 3.19, 'train_null_loss': 1.656, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 4.796, 'loss_diff': 0.0, 'epoch': 2, 'batch': 0}
{'valid_loss': 4.746, 'loss_diff': 0.0, 'epoch': 2, 'batch': 1}
{'valid_loss': 4.832, 'loss_diff': 0.0, 'epoch': 2, 'batch': 2}
Training model...
{'epoch': 3, 'batch': 0, 'train_loss': 1.686, 'train_domain_loss': 3.191, 'train_null_loss': 1.686, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 1, 'train_loss': 1.675, 'train_domain_loss': 3.175, 'train_null_loss': 1.675, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 2, 'train_loss': 1.655, 'train_domain_loss': 3.19, 'train_null_loss': 1.655, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 3, 'train_loss': 1.725, 'train_domain_loss': 3.186, 'train_null_loss': 1.725, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 4, 'train_loss': 1.665, 'train_domain_loss': 3.192, 'train_null_loss': 1.665, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 5, 'train_loss': 1.645, 'train_domain_loss': 3.175, 'train_null_loss': 1.645, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 6, 'train_loss': 1.655, 'train_domain_loss': 3.166, 'train_null_loss': 1.655, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 7, 'train_loss': 1.596, 'train_domain_loss': 3.13, 'train_null_loss': 1.596, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 8, 'train_loss': 1.638, 'train_domain_loss': 3.159, 'train_null_loss': 1.638, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 9, 'train_loss': 1.707, 'train_domain_loss': 3.127, 'train_null_loss': 1.707, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 10, 'train_loss': 1.695, 'train_domain_loss': 3.124, 'train_null_loss': 1.695, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 11, 'train_loss': 1.697, 'train_domain_loss': 3.147, 'train_null_loss': 1.697, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 12, 'train_loss': 1.798, 'train_domain_loss': 3.103, 'train_null_loss': 1.798, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 13, 'train_loss': 1.613, 'train_domain_loss': 3.12, 'train_null_loss': 1.613, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 14, 'train_loss': 1.612, 'train_domain_loss': 3.159, 'train_null_loss': 1.612, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 15, 'train_loss': 1.613, 'train_domain_loss': 3.138, 'train_null_loss': 1.613, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 16, 'train_loss': 1.616, 'train_domain_loss': 3.058, 'train_null_loss': 1.616, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 17, 'train_loss': 1.626, 'train_domain_loss': 3.051, 'train_null_loss': 1.626, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 4.164, 'loss_diff': 0.0, 'epoch': 3, 'batch': 0}
{'valid_loss': 4.401, 'loss_diff': 0.0, 'epoch': 3, 'batch': 1}
{'valid_loss': 4.231, 'loss_diff': 0.0, 'epoch': 3, 'batch': 2}
Training model...
{'epoch': 4, 'batch': 0, 'train_loss': 1.612, 'train_domain_loss': 3.023, 'train_null_loss': 1.612, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 1, 'train_loss': 1.651, 'train_domain_loss': 3.083, 'train_null_loss': 1.651, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 2, 'train_loss': 1.644, 'train_domain_loss': 3.012, 'train_null_loss': 1.644, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 3, 'train_loss': 1.703, 'train_domain_loss': 2.965, 'train_null_loss': 1.703, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 4, 'train_loss': 1.605, 'train_domain_loss': 3.041, 'train_null_loss': 1.605, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 5, 'train_loss': 1.685, 'train_domain_loss': 3.234, 'train_null_loss': 1.685, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 6, 'train_loss': 1.749, 'train_domain_loss': 2.868, 'train_null_loss': 1.749, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 7, 'train_loss': 1.703, 'train_domain_loss': 3.114, 'train_null_loss': 1.703, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 8, 'train_loss': 1.639, 'train_domain_loss': 2.967, 'train_null_loss': 1.639, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 9, 'train_loss': 1.615, 'train_domain_loss': 2.971, 'train_null_loss': 1.615, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 10, 'train_loss': 1.718, 'train_domain_loss': 3.078, 'train_null_loss': 1.718, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 11, 'train_loss': 1.657, 'train_domain_loss': 3.001, 'train_null_loss': 1.657, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 12, 'train_loss': 1.699, 'train_domain_loss': 3.095, 'train_null_loss': 1.699, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 13, 'train_loss': 1.737, 'train_domain_loss': 2.906, 'train_null_loss': 1.737, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 14, 'train_loss': 1.576, 'train_domain_loss': 2.849, 'train_null_loss': 1.576, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 15, 'train_loss': 1.666, 'train_domain_loss': 3.011, 'train_null_loss': 1.666, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 16, 'train_loss': 1.702, 'train_domain_loss': 2.967, 'train_null_loss': 1.702, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 17, 'train_loss': 1.69, 'train_domain_loss': 2.995, 'train_null_loss': 1.69, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 4.962, 'loss_diff': 0.0, 'epoch': 4, 'batch': 0}
{'valid_loss': 6.024, 'loss_diff': 0.0, 'epoch': 4, 'batch': 1}
{'valid_loss': 4.705, 'loss_diff': 0.0, 'epoch': 4, 'batch': 2}
Training embedding agent starting this epoch...
Training agent for 1200 steps...
Reward std over last 20 epochs: 0.00
Reward stable. Switching to SAC next epoch.
Training model...
{'epoch': 5, 'batch': 0, 'train_loss': 1.673, 'train_domain_loss': 2.882, 'train_null_loss': 1.691, 'train_embed_loss': 1.655, 'train_loss_diff': -0.036}
{'epoch': 5, 'batch': 1, 'train_loss': 1.676, 'train_domain_loss': 3.056, 'train_null_loss': 1.649, 'train_embed_loss': 1.703, 'train_loss_diff': 0.054}
{'epoch': 5, 'batch': 2, 'train_loss': 1.646, 'train_domain_loss': 3.039, 'train_null_loss': 1.608, 'train_embed_loss': 1.684, 'train_loss_diff': 0.076}
{'epoch': 5, 'batch': 3, 'train_loss': 1.689, 'train_domain_loss': 2.873, 'train_null_loss': 1.677, 'train_embed_loss': 1.701, 'train_loss_diff': 0.023}
{'epoch': 5, 'batch': 4, 'train_loss': 1.671, 'train_domain_loss': 2.987, 'train_null_loss': 1.687, 'train_embed_loss': 1.655, 'train_loss_diff': -0.032}
{'epoch': 5, 'batch': 5, 'train_loss': 1.661, 'train_domain_loss': 3.006, 'train_null_loss': 1.657, 'train_embed_loss': 1.665, 'train_loss_diff': 0.008}
{'epoch': 5, 'batch': 6, 'train_loss': 1.713, 'train_domain_loss': 3.018, 'train_null_loss': 1.692, 'train_embed_loss': 1.733, 'train_loss_diff': 0.04}
{'epoch': 5, 'batch': 7, 'train_loss': 1.722, 'train_domain_loss': 3.066, 'train_null_loss': 1.76, 'train_embed_loss': 1.684, 'train_loss_diff': -0.076}
{'epoch': 5, 'batch': 8, 'train_loss': 1.652, 'train_domain_loss': 2.977, 'train_null_loss': 1.689, 'train_embed_loss': 1.615, 'train_loss_diff': -0.074}
{'epoch': 5, 'batch': 9, 'train_loss': 1.642, 'train_domain_loss': 3.004, 'train_null_loss': 1.668, 'train_embed_loss': 1.616, 'train_loss_diff': -0.052}
{'epoch': 5, 'batch': 10, 'train_loss': 1.615, 'train_domain_loss': 3.069, 'train_null_loss': 1.588, 'train_embed_loss': 1.643, 'train_loss_diff': 0.055}
{'epoch': 5, 'batch': 11, 'train_loss': 1.761, 'train_domain_loss': 2.968, 'train_null_loss': 1.77, 'train_embed_loss': 1.752, 'train_loss_diff': -0.018}
{'epoch': 5, 'batch': 12, 'train_loss': 1.642, 'train_domain_loss': 2.863, 'train_null_loss': 1.651, 'train_embed_loss': 1.633, 'train_loss_diff': -0.018}
{'epoch': 5, 'batch': 13, 'train_loss': 1.61, 'train_domain_loss': 2.895, 'train_null_loss': 1.62, 'train_embed_loss': 1.6, 'train_loss_diff': -0.02}
{'epoch': 5, 'batch': 14, 'train_loss': 1.677, 'train_domain_loss': 2.958, 'train_null_loss': 1.718, 'train_embed_loss': 1.635, 'train_loss_diff': -0.083}
{'epoch': 5, 'batch': 15, 'train_loss': 1.64, 'train_domain_loss': 3.046, 'train_null_loss': 1.686, 'train_embed_loss': 1.593, 'train_loss_diff': -0.093}
{'epoch': 5, 'batch': 16, 'train_loss': 1.635, 'train_domain_loss': 2.91, 'train_null_loss': 1.632, 'train_embed_loss': 1.638, 'train_loss_diff': 0.006}
{'epoch': 5, 'batch': 17, 'train_loss': 1.596, 'train_domain_loss': 2.823, 'train_null_loss': 1.629, 'train_embed_loss': 1.562, 'train_loss_diff': -0.067}
Running validation...
{'valid_loss': 5.156, 'loss_diff': 0.0, 'epoch': 5, 'batch': 0, 'embed_loss': -0.036}
{'valid_loss': 5.594, 'loss_diff': 0.0, 'epoch': 5, 'batch': 1, 'embed_loss': -0.014}
{'valid_loss': 5.762, 'loss_diff': 0.0, 'epoch': 5, 'batch': 2, 'embed_loss': 0.046}
Training embedding agent starting this epoch...
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 235, in <module>
    best_loss = run_training(parse_config_file(args.CONFIG_FP))
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 221, in run_training
    best_loss = training.train(
        train_loader=train_dataloader,
    ...<3 lines>...
        agent_epochs=config["embed"]["epochs"]
    )
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 562, in train
    rl = build_rl(self.encoder, self.null_head, self.embed_head,
                  self.null_agent, self.embedding_agent, device,
                  train_loader, self.reward_function, agent_epochs,
                  self.embed_agent_type, self.switch_to_sac, self.policy_name, self.config)
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\rl\rl_builder.py", line 141, in build_rl
    next_obs, reward, terminated, truncated, infos = env.step(action)
                                                     ~~~~~~~~^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\stable_baselines3\common\monitor.py", line 94, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
                                                       ~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\gymnasium\wrappers\common.py", line 125, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
                                                       ~~~~~~~~~~~~~^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\rl\latent_environment.py", line 109, in step
    self._set_obs(self.current_step)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\rl\latent_environment.py", line 63, in _set_obs
    z = self.encoder(amp, phase, bvp)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\backbone\BackBoneArchitecture.py", line 74, in forward
    z_phase = self.phase_backbone(phase)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\backbone\CNN.py", line 50, in forward
    x = self.conv_layers(x)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\container.py", line 240, in forward
    input = module(input)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\envs\thesis\Lib\site-packages\torch\nn\modules\conv.py", line 549, in _conv_forward
    return F.conv2d(
           ~~~~~~~~^
        input, weight, bias, self.stride, self.padding, self.dilation, self.groups
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
KeyboardInterrupt
