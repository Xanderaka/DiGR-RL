Running training on CPU
Loading dataset train
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Loading dataset validation
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Building models...
Completed model building. Took 0.15 s.
                                                                                                                                                               
Preparation complete. Starting training...
Training model...
{'epoch': 0, 'batch': 0, 'train_loss': 1.799, 'train_elbo_loss': 0.46, 'train_null_loss': 1.799, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.517, 'train_elbo_loss': 0.42, 'train_null_loss': 1.517, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.82, 'train_elbo_loss': 0.38, 'train_null_loss': 1.82, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 3, 'train_loss': 1.941, 'train_elbo_loss': 0.344, 'train_null_loss': 1.941, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 4, 'train_loss': 1.947, 'train_elbo_loss': 0.315, 'train_null_loss': 1.947, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 5, 'train_loss': 1.925, 'train_elbo_loss': 0.289, 'train_null_loss': 1.925, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 6, 'train_loss': 1.629, 'train_elbo_loss': 0.26, 'train_null_loss': 1.629, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 7, 'train_loss': 1.755, 'train_elbo_loss': 0.24, 'train_null_loss': 1.755, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 8, 'train_loss': 1.916, 'train_elbo_loss': 0.223, 'train_null_loss': 1.916, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 9, 'train_loss': 1.808, 'train_elbo_loss': 0.21, 'train_null_loss': 1.808, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 10, 'train_loss': 1.928, 'train_elbo_loss': 0.19, 'train_null_loss': 1.928, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 11, 'train_loss': 1.668, 'train_elbo_loss': 0.165, 'train_null_loss': 1.668, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 12, 'train_loss': 1.752, 'train_elbo_loss': 0.15, 'train_null_loss': 1.752, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 13, 'train_loss': 1.946, 'train_elbo_loss': 0.131, 'train_null_loss': 1.946, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 14, 'train_loss': 1.762, 'train_elbo_loss': 0.126, 'train_null_loss': 1.762, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 15, 'train_loss': 1.777, 'train_elbo_loss': 0.103, 'train_null_loss': 1.777, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 16, 'train_loss': 1.944, 'train_elbo_loss': 0.115, 'train_null_loss': 1.944, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 17, 'train_loss': 1.831, 'train_elbo_loss': 0.089, 'train_null_loss': 1.831, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 18, 'train_loss': 1.949, 'train_elbo_loss': 0.095, 'train_null_loss': 1.949, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 19, 'train_loss': 1.753, 'train_elbo_loss': 0.08, 'train_null_loss': 1.753, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 20, 'train_loss': 1.806, 'train_elbo_loss': 0.065, 'train_null_loss': 1.806, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 21, 'train_loss': 1.948, 'train_elbo_loss': 0.063, 'train_null_loss': 1.948, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 22, 'train_loss': 1.913, 'train_elbo_loss': 0.061, 'train_null_loss': 1.913, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 23, 'train_loss': 1.946, 'train_elbo_loss': 0.062, 'train_null_loss': 1.946, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 24, 'train_loss': 1.95, 'train_elbo_loss': 0.058, 'train_null_loss': 1.95, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 25, 'train_loss': 1.775, 'train_elbo_loss': 0.064, 'train_null_loss': 1.775, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 26, 'train_loss': 1.874, 'train_elbo_loss': 0.058, 'train_null_loss': 1.874, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 27, 'train_loss': 1.767, 'train_elbo_loss': 0.05, 'train_null_loss': 1.767, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 28, 'train_loss': 1.948, 'train_elbo_loss': 0.049, 'train_null_loss': 1.948, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 29, 'train_loss': 1.744, 'train_elbo_loss': 0.052, 'train_null_loss': 1.744, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 30, 'train_loss': 1.781, 'train_elbo_loss': 0.043, 'train_null_loss': 1.781, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 31, 'train_loss': 1.845, 'train_elbo_loss': 0.047, 'train_null_loss': 1.845, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 32, 'train_loss': 1.667, 'train_elbo_loss': 0.036, 'train_null_loss': 1.667, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 33, 'train_loss': 1.87, 'train_elbo_loss': 0.04, 'train_null_loss': 1.87, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 34, 'train_loss': 1.912, 'train_elbo_loss': 0.039, 'train_null_loss': 1.912, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 35, 'train_loss': 1.842, 'train_elbo_loss': 0.034, 'train_null_loss': 1.842, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 36, 'train_loss': 1.883, 'train_elbo_loss': 0.036, 'train_null_loss': 1.883, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 37, 'train_loss': 1.711, 'train_elbo_loss': 0.036, 'train_null_loss': 1.711, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 38, 'train_loss': 1.811, 'train_elbo_loss': 0.035, 'train_null_loss': 1.811, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 39, 'train_loss': 1.811, 'train_elbo_loss': 0.031, 'train_null_loss': 1.811, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 40, 'train_loss': 1.944, 'train_elbo_loss': 0.032, 'train_null_loss': 1.944, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 41, 'train_loss': 1.622, 'train_elbo_loss': 0.028, 'train_null_loss': 1.622, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 42, 'train_loss': 1.915, 'train_elbo_loss': 0.032, 'train_null_loss': 1.915, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 43, 'train_loss': 1.95, 'train_elbo_loss': 0.032, 'train_null_loss': 1.95, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 44, 'train_loss': 1.836, 'train_elbo_loss': 0.024, 'train_null_loss': 1.836, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 45, 'train_loss': 1.84, 'train_elbo_loss': 0.032, 'train_null_loss': 1.84, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 46, 'train_loss': 1.491, 'train_elbo_loss': 0.028, 'train_null_loss': 1.491, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 47, 'train_loss': 1.76, 'train_elbo_loss': 0.031, 'train_null_loss': 1.76, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 48, 'train_loss': 1.922, 'train_elbo_loss': 0.024, 'train_null_loss': 1.922, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 49, 'train_loss': 1.897, 'train_elbo_loss': 0.031, 'train_null_loss': 1.897, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 50, 'train_loss': 1.811, 'train_elbo_loss': 0.025, 'train_null_loss': 1.811, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 51, 'train_loss': 1.945, 'train_elbo_loss': 0.021, 'train_null_loss': 1.945, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 52, 'train_loss': 1.763, 'train_elbo_loss': 0.026, 'train_null_loss': 1.763, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 53, 'train_loss': 1.653, 'train_elbo_loss': 0.027, 'train_null_loss': 1.653, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 54, 'train_loss': 1.777, 'train_elbo_loss': 0.03, 'train_null_loss': 1.777, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 55, 'train_loss': 1.948, 'train_elbo_loss': 0.022, 'train_null_loss': 1.948, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 56, 'train_loss': 1.948, 'train_elbo_loss': 0.022, 'train_null_loss': 1.948, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 57, 'train_loss': 1.784, 'train_elbo_loss': 0.024, 'train_null_loss': 1.784, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 58, 'train_loss': 1.868, 'train_elbo_loss': 0.03, 'train_null_loss': 1.868, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 59, 'train_loss': 1.731, 'train_elbo_loss': 0.022, 'train_null_loss': 1.731, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.836, 'loss_diff': 0.0, 'epoch': 0, 'batch': 0}
{'valid_loss': 1.859, 'loss_diff': 0.0, 'epoch': 0, 'batch': 1}
{'valid_loss': 1.858, 'loss_diff': 0.0, 'epoch': 0, 'batch': 2}
{'valid_loss': 1.873, 'loss_diff': 0.0, 'epoch': 0, 'batch': 3}
{'valid_loss': 1.85, 'loss_diff': 0.0, 'epoch': 0, 'batch': 4}
{'valid_loss': 1.878, 'loss_diff': 0.0, 'epoch': 0, 'batch': 5}
{'valid_loss': 1.841, 'loss_diff': 0.0, 'epoch': 0, 'batch': 6}
{'valid_loss': 1.876, 'loss_diff': 0.0, 'epoch': 0, 'batch': 7}
{'valid_loss': 1.818, 'loss_diff': 0.0, 'epoch': 0, 'batch': 8}
{'valid_loss': 1.79, 'loss_diff': 0.0, 'epoch': 0, 'batch': 9}
{'valid_loss': 1.826, 'loss_diff': 0.0, 'epoch': 0, 'batch': 10}
{'valid_loss': 1.782, 'loss_diff': 0.0, 'epoch': 0, 'batch': 11}
{'valid_loss': 1.832, 'loss_diff': 0.0, 'epoch': 0, 'batch': 12}
{'valid_loss': 1.825, 'loss_diff': 0.0, 'epoch': 0, 'batch': 13}
{'valid_loss': 1.863, 'loss_diff': 0.0, 'epoch': 0, 'batch': 14}
{'valid_loss': 1.827, 'loss_diff': 0.0, 'epoch': 0, 'batch': 15}
{'valid_loss': 1.816, 'loss_diff': 0.0, 'epoch': 0, 'batch': 16}
{'valid_loss': 1.815, 'loss_diff': 0.0, 'epoch': 0, 'batch': 17}
{'valid_loss': 1.816, 'loss_diff': 0.0, 'epoch': 0, 'batch': 18}
{'valid_loss': 1.807, 'loss_diff': 0.0, 'epoch': 0, 'batch': 19}
{'valid_loss': 1.784, 'loss_diff': 0.0, 'epoch': 0, 'batch': 20}
{'valid_loss': 1.777, 'loss_diff': 0.0, 'epoch': 0, 'batch': 21}
{'valid_loss': 1.79, 'loss_diff': 0.0, 'epoch': 0, 'batch': 22}
{'valid_loss': 1.764, 'loss_diff': 0.0, 'epoch': 0, 'batch': 23}
{'valid_loss': 1.749, 'loss_diff': 0.0, 'epoch': 0, 'batch': 24}
{'valid_loss': 1.759, 'loss_diff': 0.0, 'epoch': 0, 'batch': 25}
{'valid_loss': 1.765, 'loss_diff': 0.0, 'epoch': 0, 'batch': 26}
{'valid_loss': 1.757, 'loss_diff': 0.0, 'epoch': 0, 'batch': 27}
{'valid_loss': 1.764, 'loss_diff': 0.0, 'epoch': 0, 'batch': 28}
{'valid_loss': 1.794, 'loss_diff': 0.0, 'epoch': 0, 'batch': 29}
{'valid_loss': 1.79, 'loss_diff': 0.0, 'epoch': 0, 'batch': 30}
{'valid_loss': 1.784, 'loss_diff': 0.0, 'epoch': 0, 'batch': 31}
{'valid_loss': 1.797, 'loss_diff': 0.0, 'epoch': 0, 'batch': 32}
{'valid_loss': 1.827, 'loss_diff': 0.0, 'epoch': 0, 'batch': 33}
{'valid_loss': 1.797, 'loss_diff': 0.0, 'epoch': 0, 'batch': 34}
{'valid_loss': 1.769, 'loss_diff': 0.0, 'epoch': 0, 'batch': 35}
{'valid_loss': 1.799, 'loss_diff': 0.0, 'epoch': 0, 'batch': 36}
{'valid_loss': 1.76, 'loss_diff': 0.0, 'epoch': 0, 'batch': 37}
{'valid_loss': 1.807, 'loss_diff': 0.0, 'epoch': 0, 'batch': 38}
{'valid_loss': 1.765, 'loss_diff': 0.0, 'epoch': 0, 'batch': 39}
{'valid_loss': 1.857, 'loss_diff': 0.0, 'epoch': 0, 'batch': 40}
{'valid_loss': 1.844, 'loss_diff': 0.0, 'epoch': 0, 'batch': 41}
