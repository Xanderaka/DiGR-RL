Running training on CPU
Loading dataset train
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.01 s.
Loading dataset validation
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
{(0, 0, 0, 1): 0, (0, 1, 0, 1): 1, (0, 2, 0, 1): 2, (0, 3, 0, 1): 3, (0, 4, 0, 1): 4}
Building models...
Detected 25 unique domains.
Completed model building. Took 0.75 s.
                                                                                                                                                                     
Preparation complete. Starting training...
Training model...
Skipping gesture_null image visualization: gesture_null tensor is not image-like (got shape torch.Size([16, 6]))
Skipping domain_null image visualization: domain_null tensor is not image-like (got shape torch.Size([16, 25]))
{'epoch': 0, 'batch': 0, 'train_loss': 1.808, 'train_domain_loss': 3.272, 'train_null_loss': 1.808, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.821, 'train_domain_loss': 3.414, 'train_null_loss': 1.821, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.819, 'train_domain_loss': 3.617, 'train_null_loss': 1.819, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 3, 'train_loss': 1.766, 'train_domain_loss': 4.096, 'train_null_loss': 1.766, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 4, 'train_loss': 1.811, 'train_domain_loss': 5.28, 'train_null_loss': 1.811, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 5, 'train_loss': 1.785, 'train_domain_loss': 4.795, 'train_null_loss': 1.785, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 6, 'train_loss': 1.752, 'train_domain_loss': 5.278, 'train_null_loss': 1.752, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 7, 'train_loss': 1.758, 'train_domain_loss': 5.599, 'train_null_loss': 1.758, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 8, 'train_loss': 1.756, 'train_domain_loss': 6.598, 'train_null_loss': 1.756, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 9, 'train_loss': 1.782, 'train_domain_loss': 5.536, 'train_null_loss': 1.782, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 10, 'train_loss': 1.794, 'train_domain_loss': 7.87, 'train_null_loss': 1.794, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 11, 'train_loss': 1.776, 'train_domain_loss': 6.986, 'train_null_loss': 1.776, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 12, 'train_loss': 1.805, 'train_domain_loss': 9.837, 'train_null_loss': 1.805, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 13, 'train_loss': 1.838, 'train_domain_loss': 8.234, 'train_null_loss': 1.838, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 14, 'train_loss': 1.851, 'train_domain_loss': 9.405, 'train_null_loss': 1.851, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 15, 'train_loss': 1.757, 'train_domain_loss': 9.226, 'train_null_loss': 1.757, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 16, 'train_loss': 1.857, 'train_domain_loss': 8.249, 'train_null_loss': 1.857, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 17, 'train_loss': 1.789, 'train_domain_loss': 10.458, 'train_null_loss': 1.789, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 18, 'train_loss': 1.798, 'train_domain_loss': 10.206, 'train_null_loss': 1.798, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 19, 'train_loss': 1.815, 'train_domain_loss': 11.276, 'train_null_loss': 1.815, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 20, 'train_loss': 1.825, 'train_domain_loss': 10.585, 'train_null_loss': 1.825, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 21, 'train_loss': 1.818, 'train_domain_loss': 10.827, 'train_null_loss': 1.818, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 22, 'train_loss': 1.791, 'train_domain_loss': 9.199, 'train_null_loss': 1.791, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 23, 'train_loss': 1.785, 'train_domain_loss': 11.534, 'train_null_loss': 1.785, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 24, 'train_loss': 1.807, 'train_domain_loss': 11.774, 'train_null_loss': 1.807, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 25, 'train_loss': 1.741, 'train_domain_loss': 12.813, 'train_null_loss': 1.741, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 26, 'train_loss': 1.724, 'train_domain_loss': 10.961, 'train_null_loss': 1.724, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 27, 'train_loss': 1.772, 'train_domain_loss': 11.63, 'train_null_loss': 1.772, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 28, 'train_loss': 1.827, 'train_domain_loss': 12.492, 'train_null_loss': 1.827, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 29, 'train_loss': 1.78, 'train_domain_loss': 8.573, 'train_null_loss': 1.78, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 30, 'train_loss': 1.668, 'train_domain_loss': 11.303, 'train_null_loss': 1.668, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 31, 'train_loss': 1.776, 'train_domain_loss': 9.189, 'train_null_loss': 1.776, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 32, 'train_loss': 1.763, 'train_domain_loss': 11.492, 'train_null_loss': 1.763, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 242, in <module>
    run_training(parse_config_file(args.CONFIG_FP))
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 229, in run_training
    training.train(
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 634, in train
    curr_joint_loss = self._validate_holistic(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 343, in _validate_holistic
    pass_result = self._forward_pass(amp, phase, bvp, info["gesture"], info, device, True, domain_label)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 188, in _forward_pass
    loss_dict = self.loss_func(
                ^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\loss\multi_joint_loss.py", line 35, in forward
    null_domain_loss = self.ce(null_domain_pred, domain_label)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\nn\modules\loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\nn\functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
IndexError: Target 25 is out of bounds.
