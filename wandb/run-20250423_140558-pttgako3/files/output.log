Running training on CPU
Loading dataset train
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Loading dataset validation
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Building models...
Completed model building. Took 0.10 s.
Epoch: 1 of 50 | Validation loss: 4.66:   2%|█▌                                                                                | 224/12000 [00:04<01:58, 99.15it/s]Traceback (most recent call last):
Preparation complete. Starting training...
Training model...
Skipping gesture_null image visualization: too many indices for tensor of dimension 2
Skipping domain_null image visualization: too many indices for tensor of dimension 2
{'epoch': 0, 'batch': 0, 'train_loss': 1.833, 'train_domain_loss': 3.425, 'train_null_loss': 1.833, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.818, 'train_domain_loss': 3.453, 'train_null_loss': 1.818, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.7, 'train_domain_loss': 3.421, 'train_null_loss': 1.7, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 3, 'train_loss': 1.822, 'train_domain_loss': 3.275, 'train_null_loss': 1.822, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 4, 'train_loss': 1.775, 'train_domain_loss': 3.315, 'train_null_loss': 1.775, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 5, 'train_loss': 1.839, 'train_domain_loss': 3.266, 'train_null_loss': 1.839, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 6, 'train_loss': 1.775, 'train_domain_loss': 3.281, 'train_null_loss': 1.775, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 4.682, 'loss_diff': 0.0, 'epoch': 0, 'batch': 0}
{'valid_loss': 4.666, 'loss_diff': 0.0, 'epoch': 0, 'batch': 1}
{'valid_loss': 4.663, 'loss_diff': 0.0, 'epoch': 0, 'batch': 2}
{'valid_loss': 4.664, 'loss_diff': 0.0, 'epoch': 0, 'batch': 3}
{'valid_loss': 4.666, 'loss_diff': 0.0, 'epoch': 0, 'batch': 4}
{'valid_loss': 4.67, 'loss_diff': 0.0, 'epoch': 0, 'batch': 5}
{'valid_loss': 4.655, 'loss_diff': 0.0, 'epoch': 0, 'batch': 6}
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 209, in <module>
    run_training(parse_config_file(args.CONFIG_FP))
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train_runner.py", line 196, in run_training
    training.train(
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 640, in train
    curr_joint_loss = self._validate_holistic(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 397, in _validate_holistic
    "valid_domain_conf_mat": self._conf_matrix(domain_gts, domain_null_preds),
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Tue\Master\Jaar_2\graduation\code\own_approach\src\experiments\train.py", line 507, in _conf_matrix
    ax.matshow(self.conf_mat(gesture_gt, gesture_pred))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torchmetrics\metric.py", line 315, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torchmetrics\metric.py", line 384, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "C:\Users\xande\anaconda3\Lib\site-packages\torchmetrics\metric.py", line 559, in wrapped_func
    raise err
  File "C:\Users\xande\anaconda3\Lib\site-packages\torchmetrics\metric.py", line 549, in wrapped_func
    update(*args, **kwargs)
  File "C:\Users\xande\anaconda3\Lib\site-packages\torchmetrics\classification\confusion_matrix.py", line 285, in update
    confmat = _multiclass_confusion_matrix_update(preds, target, self.num_classes)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\xande\anaconda3\Lib\site-packages\torchmetrics\functional\classification\confusion_matrix.py", line 328, in _multiclass_confusion_matrix_update
    return bins.reshape(num_classes, num_classes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: shape '[6, 6]' is invalid for input of size 110
