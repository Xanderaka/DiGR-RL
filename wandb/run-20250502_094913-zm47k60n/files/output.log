Running training on CPU
Loading dataset train
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Loading dataset validation
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Building models...
Completed model building. Took 0.10 s.
                                                                                                                                              
Preparation complete. Starting training...
Training model...
{'epoch': 0, 'batch': 0, 'train_loss': 1.781, 'train_elbo_loss': 0.43, 'train_null_loss': 1.781, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.813, 'train_elbo_loss': 0.375, 'train_null_loss': 1.813, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.846, 'train_elbo_loss': 0.336, 'train_null_loss': 1.846, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 3, 'train_loss': 1.762, 'train_elbo_loss': 0.312, 'train_null_loss': 1.762, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 4, 'train_loss': 1.805, 'train_elbo_loss': 0.287, 'train_null_loss': 1.805, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 5, 'train_loss': 1.7, 'train_elbo_loss': 0.241, 'train_null_loss': 1.7, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 6, 'train_loss': 1.819, 'train_elbo_loss': 0.229, 'train_null_loss': 1.819, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.311, 'loss_diff': 0.0, 'epoch': 0, 'batch': 0}
{'valid_loss': 2.297, 'loss_diff': 0.0, 'epoch': 0, 'batch': 1}
{'valid_loss': 2.249, 'loss_diff': 0.0, 'epoch': 0, 'batch': 2}
{'valid_loss': 2.224, 'loss_diff': 0.0, 'epoch': 0, 'batch': 3}
{'valid_loss': 2.266, 'loss_diff': 0.0, 'epoch': 0, 'batch': 4}
{'valid_loss': 2.217, 'loss_diff': 0.0, 'epoch': 0, 'batch': 5}
{'valid_loss': 2.205, 'loss_diff': 0.0, 'epoch': 0, 'batch': 6}
Training model...
{'epoch': 1, 'batch': 0, 'train_loss': 1.813, 'train_elbo_loss': 0.211, 'train_null_loss': 1.813, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 1, 'train_loss': 1.837, 'train_elbo_loss': 0.181, 'train_null_loss': 1.837, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 2, 'train_loss': 1.82, 'train_elbo_loss': 0.167, 'train_null_loss': 1.82, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 3, 'train_loss': 1.656, 'train_elbo_loss': 0.148, 'train_null_loss': 1.656, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 4, 'train_loss': 1.72, 'train_elbo_loss': 0.137, 'train_null_loss': 1.72, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 5, 'train_loss': 1.807, 'train_elbo_loss': 0.11, 'train_null_loss': 1.807, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 6, 'train_loss': 1.78, 'train_elbo_loss': 0.102, 'train_null_loss': 1.78, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.27, 'loss_diff': 0.0, 'epoch': 1, 'batch': 0}
{'valid_loss': 2.268, 'loss_diff': 0.0, 'epoch': 1, 'batch': 1}
{'valid_loss': 2.212, 'loss_diff': 0.0, 'epoch': 1, 'batch': 2}
{'valid_loss': 2.186, 'loss_diff': 0.0, 'epoch': 1, 'batch': 3}
{'valid_loss': 2.267, 'loss_diff': 0.0, 'epoch': 1, 'batch': 4}
{'valid_loss': 2.119, 'loss_diff': 0.0, 'epoch': 1, 'batch': 5}
{'valid_loss': 2.074, 'loss_diff': 0.0, 'epoch': 1, 'batch': 6}
Training model...
{'epoch': 2, 'batch': 0, 'train_loss': 1.839, 'train_elbo_loss': 0.097, 'train_null_loss': 1.839, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 1, 'train_loss': 1.794, 'train_elbo_loss': 0.075, 'train_null_loss': 1.794, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 2, 'train_loss': 1.73, 'train_elbo_loss': 0.069, 'train_null_loss': 1.73, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 3, 'train_loss': 1.7, 'train_elbo_loss': 0.065, 'train_null_loss': 1.7, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 4, 'train_loss': 1.749, 'train_elbo_loss': 0.057, 'train_null_loss': 1.749, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 5, 'train_loss': 1.835, 'train_elbo_loss': 0.052, 'train_null_loss': 1.835, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 6, 'train_loss': 1.696, 'train_elbo_loss': 0.046, 'train_null_loss': 1.696, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.134, 'loss_diff': 0.0, 'epoch': 2, 'batch': 0}
{'valid_loss': 2.136, 'loss_diff': 0.0, 'epoch': 2, 'batch': 1}
{'valid_loss': 2.093, 'loss_diff': 0.0, 'epoch': 2, 'batch': 2}
{'valid_loss': 2.075, 'loss_diff': 0.0, 'epoch': 2, 'batch': 3}
{'valid_loss': 2.15, 'loss_diff': 0.0, 'epoch': 2, 'batch': 4}
{'valid_loss': 1.966, 'loss_diff': 0.0, 'epoch': 2, 'batch': 5}
{'valid_loss': 1.877, 'loss_diff': 0.0, 'epoch': 2, 'batch': 6}
Training model...
{'epoch': 3, 'batch': 0, 'train_loss': 1.702, 'train_elbo_loss': 0.043, 'train_null_loss': 1.702, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 1, 'train_loss': 1.781, 'train_elbo_loss': 0.04, 'train_null_loss': 1.781, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 2, 'train_loss': 1.668, 'train_elbo_loss': 0.04, 'train_null_loss': 1.668, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 3, 'train_loss': 1.655, 'train_elbo_loss': 0.038, 'train_null_loss': 1.655, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 4, 'train_loss': 1.769, 'train_elbo_loss': 0.033, 'train_null_loss': 1.769, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 5, 'train_loss': 1.703, 'train_elbo_loss': 0.035, 'train_null_loss': 1.703, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 6, 'train_loss': 1.785, 'train_elbo_loss': 0.031, 'train_null_loss': 1.785, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.0, 'loss_diff': 0.0, 'epoch': 3, 'batch': 0}
{'valid_loss': 1.997, 'loss_diff': 0.0, 'epoch': 3, 'batch': 1}
{'valid_loss': 1.945, 'loss_diff': 0.0, 'epoch': 3, 'batch': 2}
{'valid_loss': 1.918, 'loss_diff': 0.0, 'epoch': 3, 'batch': 3}
{'valid_loss': 1.989, 'loss_diff': 0.0, 'epoch': 3, 'batch': 4}
{'valid_loss': 1.738, 'loss_diff': 0.0, 'epoch': 3, 'batch': 5}
{'valid_loss': 1.723, 'loss_diff': 0.0, 'epoch': 3, 'batch': 6}
Training model...
{'epoch': 4, 'batch': 0, 'train_loss': 1.704, 'train_elbo_loss': 0.032, 'train_null_loss': 1.704, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 1, 'train_loss': 1.789, 'train_elbo_loss': 0.03, 'train_null_loss': 1.789, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 2, 'train_loss': 1.868, 'train_elbo_loss': 0.028, 'train_null_loss': 1.868, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 3, 'train_loss': 1.752, 'train_elbo_loss': 0.029, 'train_null_loss': 1.752, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 4, 'train_loss': 1.694, 'train_elbo_loss': 0.027, 'train_null_loss': 1.694, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 5, 'train_loss': 1.773, 'train_elbo_loss': 0.027, 'train_null_loss': 1.773, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 6, 'train_loss': 1.707, 'train_elbo_loss': 0.025, 'train_null_loss': 1.707, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.967, 'loss_diff': 0.0, 'epoch': 4, 'batch': 0}
{'valid_loss': 1.966, 'loss_diff': 0.0, 'epoch': 4, 'batch': 1}
{'valid_loss': 1.903, 'loss_diff': 0.0, 'epoch': 4, 'batch': 2}
{'valid_loss': 1.863, 'loss_diff': 0.0, 'epoch': 4, 'batch': 3}
{'valid_loss': 1.94, 'loss_diff': 0.0, 'epoch': 4, 'batch': 4}
{'valid_loss': 1.542, 'loss_diff': 0.0, 'epoch': 4, 'batch': 5}
{'valid_loss': 1.71, 'loss_diff': 0.0, 'epoch': 4, 'batch': 6}
Training model...
{'epoch': 5, 'batch': 0, 'train_loss': 1.728, 'train_elbo_loss': 0.025, 'train_null_loss': 1.728, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 1, 'train_loss': 1.67, 'train_elbo_loss': 0.026, 'train_null_loss': 1.67, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 2, 'train_loss': 1.67, 'train_elbo_loss': 0.025, 'train_null_loss': 1.67, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 3, 'train_loss': 1.764, 'train_elbo_loss': 0.024, 'train_null_loss': 1.764, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 4, 'train_loss': 1.727, 'train_elbo_loss': 0.022, 'train_null_loss': 1.727, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 5, 'train_loss': 1.747, 'train_elbo_loss': 0.024, 'train_null_loss': 1.747, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 6, 'train_loss': 1.764, 'train_elbo_loss': 0.022, 'train_null_loss': 1.764, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.892, 'loss_diff': 0.0, 'epoch': 5, 'batch': 0}
{'valid_loss': 1.923, 'loss_diff': 0.0, 'epoch': 5, 'batch': 1}
{'valid_loss': 1.906, 'loss_diff': 0.0, 'epoch': 5, 'batch': 2}
{'valid_loss': 1.89, 'loss_diff': 0.0, 'epoch': 5, 'batch': 3}
{'valid_loss': 1.929, 'loss_diff': 0.0, 'epoch': 5, 'batch': 4}
{'valid_loss': 1.576, 'loss_diff': 0.0, 'epoch': 5, 'batch': 5}
{'valid_loss': 1.692, 'loss_diff': 0.0, 'epoch': 5, 'batch': 6}
Training model...
{'epoch': 6, 'batch': 0, 'train_loss': 1.704, 'train_elbo_loss': 0.023, 'train_null_loss': 1.704, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 1, 'train_loss': 1.753, 'train_elbo_loss': 0.022, 'train_null_loss': 1.753, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 2, 'train_loss': 1.804, 'train_elbo_loss': 0.022, 'train_null_loss': 1.804, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 3, 'train_loss': 1.691, 'train_elbo_loss': 0.021, 'train_null_loss': 1.691, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 4, 'train_loss': 1.619, 'train_elbo_loss': 0.021, 'train_null_loss': 1.619, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 5, 'train_loss': 1.737, 'train_elbo_loss': 0.021, 'train_null_loss': 1.737, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 6, 'train_loss': 1.707, 'train_elbo_loss': 0.023, 'train_null_loss': 1.707, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.9, 'loss_diff': 0.0, 'epoch': 6, 'batch': 0}
{'valid_loss': 1.9, 'loss_diff': 0.0, 'epoch': 6, 'batch': 1}
{'valid_loss': 1.877, 'loss_diff': 0.0, 'epoch': 6, 'batch': 2}
{'valid_loss': 1.869, 'loss_diff': 0.0, 'epoch': 6, 'batch': 3}
{'valid_loss': 1.856, 'loss_diff': 0.0, 'epoch': 6, 'batch': 4}
{'valid_loss': 1.62, 'loss_diff': 0.0, 'epoch': 6, 'batch': 5}
{'valid_loss': 1.665, 'loss_diff': 0.0, 'epoch': 6, 'batch': 6}
Training model...
{'epoch': 7, 'batch': 0, 'train_loss': 1.733, 'train_elbo_loss': 0.021, 'train_null_loss': 1.733, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 1, 'train_loss': 1.588, 'train_elbo_loss': 0.021, 'train_null_loss': 1.588, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 2, 'train_loss': 1.697, 'train_elbo_loss': 0.02, 'train_null_loss': 1.697, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 3, 'train_loss': 1.646, 'train_elbo_loss': 0.021, 'train_null_loss': 1.646, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 4, 'train_loss': 1.69, 'train_elbo_loss': 0.021, 'train_null_loss': 1.69, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 5, 'train_loss': 1.635, 'train_elbo_loss': 0.02, 'train_null_loss': 1.635, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 6, 'train_loss': 1.763, 'train_elbo_loss': 0.02, 'train_null_loss': 1.763, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.911, 'loss_diff': 0.0, 'epoch': 7, 'batch': 0}
{'valid_loss': 1.879, 'loss_diff': 0.0, 'epoch': 7, 'batch': 1}
{'valid_loss': 1.855, 'loss_diff': 0.0, 'epoch': 7, 'batch': 2}
{'valid_loss': 1.834, 'loss_diff': 0.0, 'epoch': 7, 'batch': 3}
{'valid_loss': 1.783, 'loss_diff': 0.0, 'epoch': 7, 'batch': 4}
{'valid_loss': 1.629, 'loss_diff': 0.0, 'epoch': 7, 'batch': 5}
{'valid_loss': 1.642, 'loss_diff': 0.0, 'epoch': 7, 'batch': 6}
Training model...
{'epoch': 8, 'batch': 0, 'train_loss': 1.638, 'train_elbo_loss': 0.018, 'train_null_loss': 1.638, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 1, 'train_loss': 1.631, 'train_elbo_loss': 0.02, 'train_null_loss': 1.631, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 2, 'train_loss': 1.683, 'train_elbo_loss': 0.02, 'train_null_loss': 1.683, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 3, 'train_loss': 1.647, 'train_elbo_loss': 0.019, 'train_null_loss': 1.647, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 4, 'train_loss': 1.67, 'train_elbo_loss': 0.02, 'train_null_loss': 1.67, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 5, 'train_loss': 1.728, 'train_elbo_loss': 0.019, 'train_null_loss': 1.728, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 6, 'train_loss': 1.723, 'train_elbo_loss': 0.02, 'train_null_loss': 1.723, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.779, 'loss_diff': 0.0, 'epoch': 8, 'batch': 0}
{'valid_loss': 1.775, 'loss_diff': 0.0, 'epoch': 8, 'batch': 1}
{'valid_loss': 1.814, 'loss_diff': 0.0, 'epoch': 8, 'batch': 2}
{'valid_loss': 1.933, 'loss_diff': 0.0, 'epoch': 8, 'batch': 3}
{'valid_loss': 1.886, 'loss_diff': 0.0, 'epoch': 8, 'batch': 4}
{'valid_loss': 1.642, 'loss_diff': 0.0, 'epoch': 8, 'batch': 5}
{'valid_loss': 1.634, 'loss_diff': 0.0, 'epoch': 8, 'batch': 6}
Training model...
{'epoch': 9, 'batch': 0, 'train_loss': 1.723, 'train_elbo_loss': 0.021, 'train_null_loss': 1.723, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 1, 'train_loss': 1.682, 'train_elbo_loss': 0.019, 'train_null_loss': 1.682, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 2, 'train_loss': 1.63, 'train_elbo_loss': 0.018, 'train_null_loss': 1.63, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 3, 'train_loss': 1.66, 'train_elbo_loss': 0.019, 'train_null_loss': 1.66, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 4, 'train_loss': 1.71, 'train_elbo_loss': 0.018, 'train_null_loss': 1.71, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 5, 'train_loss': 1.681, 'train_elbo_loss': 0.019, 'train_null_loss': 1.681, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 6, 'train_loss': 1.657, 'train_elbo_loss': 0.019, 'train_null_loss': 1.657, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.675, 'loss_diff': 0.0, 'epoch': 9, 'batch': 0}
{'valid_loss': 1.842, 'loss_diff': 0.0, 'epoch': 9, 'batch': 1}
{'valid_loss': 1.903, 'loss_diff': 0.0, 'epoch': 9, 'batch': 2}
{'valid_loss': 1.882, 'loss_diff': 0.0, 'epoch': 9, 'batch': 3}
{'valid_loss': 1.921, 'loss_diff': 0.0, 'epoch': 9, 'batch': 4}
{'valid_loss': 1.564, 'loss_diff': 0.0, 'epoch': 9, 'batch': 5}
{'valid_loss': 1.649, 'loss_diff': 0.0, 'epoch': 9, 'batch': 6}
Training model...
{'epoch': 10, 'batch': 0, 'train_loss': 1.749, 'train_elbo_loss': 0.02, 'train_null_loss': 1.749, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 1, 'train_loss': 1.659, 'train_elbo_loss': 0.017, 'train_null_loss': 1.659, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 2, 'train_loss': 1.66, 'train_elbo_loss': 0.019, 'train_null_loss': 1.66, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 3, 'train_loss': 1.637, 'train_elbo_loss': 0.019, 'train_null_loss': 1.637, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 4, 'train_loss': 1.622, 'train_elbo_loss': 0.02, 'train_null_loss': 1.622, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 5, 'train_loss': 1.773, 'train_elbo_loss': 0.019, 'train_null_loss': 1.773, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 6, 'train_loss': 1.669, 'train_elbo_loss': 0.017, 'train_null_loss': 1.669, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.808, 'loss_diff': 0.0, 'epoch': 10, 'batch': 0}
{'valid_loss': 1.87, 'loss_diff': 0.0, 'epoch': 10, 'batch': 1}
{'valid_loss': 1.815, 'loss_diff': 0.0, 'epoch': 10, 'batch': 2}
{'valid_loss': 1.721, 'loss_diff': 0.0, 'epoch': 10, 'batch': 3}
{'valid_loss': 1.935, 'loss_diff': 0.0, 'epoch': 10, 'batch': 4}
{'valid_loss': 1.601, 'loss_diff': 0.0, 'epoch': 10, 'batch': 5}
{'valid_loss': 1.644, 'loss_diff': 0.0, 'epoch': 10, 'batch': 6}
Training model...
{'epoch': 11, 'batch': 0, 'train_loss': 1.727, 'train_elbo_loss': 0.019, 'train_null_loss': 1.727, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 1, 'train_loss': 1.771, 'train_elbo_loss': 0.019, 'train_null_loss': 1.771, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 2, 'train_loss': 1.73, 'train_elbo_loss': 0.018, 'train_null_loss': 1.73, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 3, 'train_loss': 1.717, 'train_elbo_loss': 0.018, 'train_null_loss': 1.717, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 4, 'train_loss': 1.732, 'train_elbo_loss': 0.017, 'train_null_loss': 1.732, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 5, 'train_loss': 1.756, 'train_elbo_loss': 0.02, 'train_null_loss': 1.756, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 6, 'train_loss': 1.543, 'train_elbo_loss': 0.019, 'train_null_loss': 1.543, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.69, 'loss_diff': 0.0, 'epoch': 11, 'batch': 0}
{'valid_loss': 1.732, 'loss_diff': 0.0, 'epoch': 11, 'batch': 1}
{'valid_loss': 1.845, 'loss_diff': 0.0, 'epoch': 11, 'batch': 2}
{'valid_loss': 1.822, 'loss_diff': 0.0, 'epoch': 11, 'batch': 3}
{'valid_loss': 1.954, 'loss_diff': 0.0, 'epoch': 11, 'batch': 4}
{'valid_loss': 1.802, 'loss_diff': 0.0, 'epoch': 11, 'batch': 5}
{'valid_loss': 1.63, 'loss_diff': 0.0, 'epoch': 11, 'batch': 6}
Training model...
{'epoch': 12, 'batch': 0, 'train_loss': 1.757, 'train_elbo_loss': 0.019, 'train_null_loss': 1.757, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 1, 'train_loss': 1.672, 'train_elbo_loss': 0.02, 'train_null_loss': 1.672, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 2, 'train_loss': 1.759, 'train_elbo_loss': 0.018, 'train_null_loss': 1.759, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 3, 'train_loss': 1.565, 'train_elbo_loss': 0.017, 'train_null_loss': 1.565, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 4, 'train_loss': 1.589, 'train_elbo_loss': 0.018, 'train_null_loss': 1.589, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 5, 'train_loss': 1.63, 'train_elbo_loss': 0.018, 'train_null_loss': 1.63, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 6, 'train_loss': 1.637, 'train_elbo_loss': 0.019, 'train_null_loss': 1.637, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.746, 'loss_diff': 0.0, 'epoch': 12, 'batch': 0}
{'valid_loss': 1.793, 'loss_diff': 0.0, 'epoch': 12, 'batch': 1}
{'valid_loss': 1.87, 'loss_diff': 0.0, 'epoch': 12, 'batch': 2}
{'valid_loss': 1.81, 'loss_diff': 0.0, 'epoch': 12, 'batch': 3}
{'valid_loss': 1.916, 'loss_diff': 0.0, 'epoch': 12, 'batch': 4}
{'valid_loss': 1.749, 'loss_diff': 0.0, 'epoch': 12, 'batch': 5}
{'valid_loss': 1.623, 'loss_diff': 0.0, 'epoch': 12, 'batch': 6}
Training model...
{'epoch': 13, 'batch': 0, 'train_loss': 1.577, 'train_elbo_loss': 0.018, 'train_null_loss': 1.577, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 1, 'train_loss': 1.496, 'train_elbo_loss': 0.019, 'train_null_loss': 1.496, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 2, 'train_loss': 1.678, 'train_elbo_loss': 0.018, 'train_null_loss': 1.678, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 3, 'train_loss': 1.562, 'train_elbo_loss': 0.018, 'train_null_loss': 1.562, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 4, 'train_loss': 1.701, 'train_elbo_loss': 0.018, 'train_null_loss': 1.701, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 5, 'train_loss': 1.615, 'train_elbo_loss': 0.018, 'train_null_loss': 1.615, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 6, 'train_loss': 1.707, 'train_elbo_loss': 0.019, 'train_null_loss': 1.707, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.749, 'loss_diff': 0.0, 'epoch': 13, 'batch': 0}
{'valid_loss': 1.824, 'loss_diff': 0.0, 'epoch': 13, 'batch': 1}
{'valid_loss': 1.909, 'loss_diff': 0.0, 'epoch': 13, 'batch': 2}
{'valid_loss': 1.902, 'loss_diff': 0.0, 'epoch': 13, 'batch': 3}
{'valid_loss': 1.938, 'loss_diff': 0.0, 'epoch': 13, 'batch': 4}
{'valid_loss': 1.578, 'loss_diff': 0.0, 'epoch': 13, 'batch': 5}
{'valid_loss': 1.67, 'loss_diff': 0.0, 'epoch': 13, 'batch': 6}
Training model...
{'epoch': 14, 'batch': 0, 'train_loss': 1.727, 'train_elbo_loss': 0.019, 'train_null_loss': 1.727, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 1, 'train_loss': 1.716, 'train_elbo_loss': 0.018, 'train_null_loss': 1.716, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 2, 'train_loss': 1.516, 'train_elbo_loss': 0.018, 'train_null_loss': 1.516, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 3, 'train_loss': 1.488, 'train_elbo_loss': 0.017, 'train_null_loss': 1.488, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 4, 'train_loss': 1.605, 'train_elbo_loss': 0.017, 'train_null_loss': 1.605, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 5, 'train_loss': 1.549, 'train_elbo_loss': 0.018, 'train_null_loss': 1.549, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 6, 'train_loss': 1.578, 'train_elbo_loss': 0.018, 'train_null_loss': 1.578, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.732, 'loss_diff': 0.0, 'epoch': 14, 'batch': 0}
{'valid_loss': 1.808, 'loss_diff': 0.0, 'epoch': 14, 'batch': 1}
{'valid_loss': 1.882, 'loss_diff': 0.0, 'epoch': 14, 'batch': 2}
{'valid_loss': 1.894, 'loss_diff': 0.0, 'epoch': 14, 'batch': 3}
{'valid_loss': 1.907, 'loss_diff': 0.0, 'epoch': 14, 'batch': 4}
{'valid_loss': 1.662, 'loss_diff': 0.0, 'epoch': 14, 'batch': 5}
{'valid_loss': 1.669, 'loss_diff': 0.0, 'epoch': 14, 'batch': 6}
Training embedding agent starting this epoch...
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Training agent for 240 steps...
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 120      |
|    ep_rew_mean     | 15.5     |
| time/              |          |
|    fps             | 31       |
|    iterations      | 1        |
|    time_elapsed    | 64       |
|    total_timesteps | 2048     |
---------------------------------
Training model...
{'epoch': 15, 'batch': 0, 'train_loss': 1.589, 'train_elbo_loss': 0.019, 'train_null_loss': 1.562, 'train_embed_loss': 1.617, 'train_loss_diff': 0.055}
{'epoch': 15, 'batch': 1, 'train_loss': 1.532, 'train_elbo_loss': 0.017, 'train_null_loss': 1.572, 'train_embed_loss': 1.491, 'train_loss_diff': -0.081}
{'epoch': 15, 'batch': 2, 'train_loss': 1.62, 'train_elbo_loss': 0.017, 'train_null_loss': 1.619, 'train_embed_loss': 1.62, 'train_loss_diff': 0.001}
{'epoch': 15, 'batch': 3, 'train_loss': 1.495, 'train_elbo_loss': 0.018, 'train_null_loss': 1.536, 'train_embed_loss': 1.454, 'train_loss_diff': -0.083}
{'epoch': 15, 'batch': 4, 'train_loss': 1.601, 'train_elbo_loss': 0.017, 'train_null_loss': 1.573, 'train_embed_loss': 1.629, 'train_loss_diff': 0.055}
{'epoch': 15, 'batch': 5, 'train_loss': 1.617, 'train_elbo_loss': 0.017, 'train_null_loss': 1.734, 'train_embed_loss': 1.499, 'train_loss_diff': -0.235}
{'epoch': 15, 'batch': 6, 'train_loss': 1.661, 'train_elbo_loss': 0.019, 'train_null_loss': 1.609, 'train_embed_loss': 1.713, 'train_loss_diff': 0.104}
Running validation...
{'valid_loss': 3.461, 'loss_diff': 0.0, 'epoch': 15, 'batch': 0, 'embed_loss': -0.007}
{'valid_loss': 3.546, 'loss_diff': 0.0, 'epoch': 15, 'batch': 1, 'embed_loss': -0.021}
{'valid_loss': 3.71, 'loss_diff': 0.0, 'epoch': 15, 'batch': 2, 'embed_loss': -0.008}
{'valid_loss': 3.672, 'loss_diff': 0.0, 'epoch': 15, 'batch': 3, 'embed_loss': -0.0}
{'valid_loss': 3.72, 'loss_diff': 0.0, 'epoch': 15, 'batch': 4, 'embed_loss': 0.012}
{'valid_loss': 3.33, 'loss_diff': 0.0, 'epoch': 15, 'batch': 5, 'embed_loss': 0.017}
{'valid_loss': 3.427, 'loss_diff': 0.0, 'epoch': 15, 'batch': 6, 'embed_loss': 0.004}
3.5520704024072205
Training agent for 240 steps...
