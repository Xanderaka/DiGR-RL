Running training on CPU
Loading dataset train
Loading complete. Took 0.00 s.
Loading dataset validation
Loading complete. Took 0.00 s.
Building models...
Completed model building. Took 3.86 s.
                                                                                                                                                               
Preparation complete. Starting training...
Training VAE model...
{'epoch': 0, 'batch': 0, 'train_loss': 1.731, 'train_elbo_loss': 0.542, 'train_null_loss': 1.731, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.854, 'train_elbo_loss': 25.597, 'train_null_loss': 1.854, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.733, 'train_elbo_loss': 1016.793, 'train_null_loss': 1.733, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.27, 'loss_diff': 0.0, 'epoch': 0, 'batch': 0}
{'valid_loss': 2.283, 'loss_diff': 0.0, 'epoch': 0, 'batch': 1}
{'valid_loss': 2.282, 'loss_diff': 0.0, 'epoch': 0, 'batch': 2}
Training VAE model...
{'epoch': 1, 'batch': 0, 'train_loss': 1.846, 'train_elbo_loss': 32020.451, 'train_null_loss': 1.846, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 1, 'train_loss': 1.835, 'train_elbo_loss': 1854128.0, 'train_null_loss': 1.835, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 2, 'train_loss': 1.766, 'train_elbo_loss': 45563676.0, 'train_null_loss': 1.766, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.463, 'loss_diff': 0.0, 'epoch': 1, 'batch': 0}
{'valid_loss': 2.486, 'loss_diff': 0.0, 'epoch': 1, 'batch': 1}
{'valid_loss': 2.487, 'loss_diff': 0.0, 'epoch': 1, 'batch': 2}
Training VAE model...
{'epoch': 2, 'batch': 0, 'train_loss': 1.764, 'train_elbo_loss': 1048262528.0, 'train_null_loss': 1.764, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 1, 'train_loss': 1.824, 'train_elbo_loss': 13613690880.0, 'train_null_loss': 1.824, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 2, 'train_loss': 1.831, 'train_elbo_loss': 122273947648.0, 'train_null_loss': 1.831, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 3.669, 'loss_diff': 0.0, 'epoch': 2, 'batch': 0}
{'valid_loss': 3.691, 'loss_diff': 0.0, 'epoch': 2, 'batch': 1}
{'valid_loss': 3.712, 'loss_diff': 0.0, 'epoch': 2, 'batch': 2}
Training VAE model...
{'epoch': 3, 'batch': 0, 'train_loss': 1.805, 'train_elbo_loss': 566429483008.0, 'train_null_loss': 1.805, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 1, 'train_loss': 1.825, 'train_elbo_loss': 7206347997184.0, 'train_null_loss': 1.825, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 2, 'train_loss': 1.848, 'train_elbo_loss': 159940756897792.0, 'train_null_loss': 1.848, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 10.179, 'loss_diff': 0.0, 'epoch': 3, 'batch': 0}
{'valid_loss': 10.171, 'loss_diff': 0.0, 'epoch': 3, 'batch': 1}
{'valid_loss': 10.248, 'loss_diff': 0.0, 'epoch': 3, 'batch': 2}
Training VAE model...
{'epoch': 4, 'batch': 0, 'train_loss': 1.829, 'train_elbo_loss': 276025367855104.0, 'train_null_loss': 1.829, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 1, 'train_loss': 1.787, 'train_elbo_loss': 606508907757568.0, 'train_null_loss': 1.787, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 2, 'train_loss': 1.809, 'train_elbo_loss': 1168419411984384.0, 'train_null_loss': 1.809, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 47.738, 'loss_diff': 0.0, 'epoch': 4, 'batch': 0}
{'valid_loss': 47.387, 'loss_diff': 0.0, 'epoch': 4, 'batch': 1}
{'valid_loss': 48.057, 'loss_diff': 0.0, 'epoch': 4, 'batch': 2}
Training VAE model...
{'epoch': 5, 'batch': 0, 'train_loss': 1.76, 'train_elbo_loss': 6798628823760896.0, 'train_null_loss': 1.76, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 1, 'train_loss': 1.799, 'train_elbo_loss': 1.9355231464718336e+16, 'train_null_loss': 1.799, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 2, 'train_loss': 1.745, 'train_elbo_loss': 3.651030580251853e+16, 'train_null_loss': 1.745, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 277.85, 'loss_diff': 0.0, 'epoch': 5, 'batch': 0}
{'valid_loss': 273.928, 'loss_diff': 0.0, 'epoch': 5, 'batch': 1}
{'valid_loss': 280.715, 'loss_diff': 0.0, 'epoch': 5, 'batch': 2}
Training VAE model...
{'epoch': 6, 'batch': 0, 'train_loss': 1.837, 'train_elbo_loss': 3.759419577524552e+17, 'train_null_loss': 1.837, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 1, 'train_loss': 1.779, 'train_elbo_loss': 7.281889417101312e+16, 'train_null_loss': 1.779, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 2, 'train_loss': 1.795, 'train_elbo_loss': 6.925168159552963e+17, 'train_null_loss': 1.795, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1698.686, 'loss_diff': 0.0, 'epoch': 6, 'batch': 0}
{'valid_loss': 1657.799, 'loss_diff': 0.0, 'epoch': 6, 'batch': 1}
{'valid_loss': 1726.574, 'loss_diff': 0.0, 'epoch': 6, 'batch': 2}
Training VAE model...
{'epoch': 7, 'batch': 0, 'train_loss': 1.801, 'train_elbo_loss': 2.122660798613422e+18, 'train_null_loss': 1.801, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 1, 'train_loss': 1.82, 'train_elbo_loss': 1.8763303366950912e+18, 'train_null_loss': 1.82, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 2, 'train_loss': 1.856, 'train_elbo_loss': 4.804081311834702e+18, 'train_null_loss': 1.856, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 9899.803, 'loss_diff': 0.0, 'epoch': 7, 'batch': 0}
{'valid_loss': 9523.209, 'loss_diff': 0.0, 'epoch': 7, 'batch': 1}
{'valid_loss': 10143.95, 'loss_diff': 0.0, 'epoch': 7, 'batch': 2}
Training VAE model...
{'epoch': 8, 'batch': 0, 'train_loss': 1.85, 'train_elbo_loss': 5.607686323029672e+18, 'train_null_loss': 1.85, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 1, 'train_loss': 1.798, 'train_elbo_loss': 1.882626002836783e+18, 'train_null_loss': 1.798, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 2, 'train_loss': 1.818, 'train_elbo_loss': 1.4438096202652189e+19, 'train_null_loss': 1.818, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 52894.101, 'loss_diff': 0.0, 'epoch': 8, 'batch': 0}
{'valid_loss': 49799.179, 'loss_diff': 0.0, 'epoch': 8, 'batch': 1}
{'valid_loss': 54597.464, 'loss_diff': 0.0, 'epoch': 8, 'batch': 2}
Training VAE model...
{'epoch': 9, 'batch': 0, 'train_loss': 1.779, 'train_elbo_loss': 5.144022269596533e+18, 'train_null_loss': 1.779, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 1, 'train_loss': 1.797, 'train_elbo_loss': 7.854533936343417e+18, 'train_null_loss': 1.797, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 2, 'train_loss': 1.819, 'train_elbo_loss': 1.4313859657040942e+21, 'train_null_loss': 1.819, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 278188.957, 'loss_diff': 0.0, 'epoch': 9, 'batch': 0}
{'valid_loss': 254991.481, 'loss_diff': 0.0, 'epoch': 9, 'batch': 1}
{'valid_loss': 287407.182, 'loss_diff': 0.0, 'epoch': 9, 'batch': 2}
Training VAE model...
{'epoch': 10, 'batch': 0, 'train_loss': 1.842, 'train_elbo_loss': 6.569882692391797e+18, 'train_null_loss': 1.842, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 1, 'train_loss': 1.843, 'train_elbo_loss': 8.223683750350606e+19, 'train_null_loss': 1.843, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 10, 'batch': 2, 'train_loss': 1.802, 'train_elbo_loss': 1.0189341380367614e+20, 'train_null_loss': 1.802, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2450172.461, 'loss_diff': 0.0, 'epoch': 10, 'batch': 0}
{'valid_loss': 2177306.051, 'loss_diff': 0.0, 'epoch': 10, 'batch': 1}
{'valid_loss': 2503458.806, 'loss_diff': 0.0, 'epoch': 10, 'batch': 2}
Training VAE model...
{'epoch': 11, 'batch': 0, 'train_loss': 1.858, 'train_elbo_loss': 4.289606517107615e+19, 'train_null_loss': 1.858, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 1, 'train_loss': 1.791, 'train_elbo_loss': 1.6754181558502802e+21, 'train_null_loss': 1.791, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 11, 'batch': 2, 'train_loss': 1.821, 'train_elbo_loss': 9.663842376285097e+20, 'train_null_loss': 1.821, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 137799825.751, 'loss_diff': 0.0, 'epoch': 11, 'batch': 0}
{'valid_loss': 117675217.82, 'loss_diff': 0.0, 'epoch': 11, 'batch': 1}
{'valid_loss': 136621969.809, 'loss_diff': 0.0, 'epoch': 11, 'batch': 2}
Training VAE model...
{'epoch': 12, 'batch': 0, 'train_loss': 1.85, 'train_elbo_loss': 6.125666059120118e+22, 'train_null_loss': 1.85, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 1, 'train_loss': 1.83, 'train_elbo_loss': 4.0828816368048586e+23, 'train_null_loss': 1.83, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 12, 'batch': 2, 'train_loss': 1.807, 'train_elbo_loss': 1.0013082194681864e+24, 'train_null_loss': 1.807, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 10564341761.736, 'loss_diff': 0.0, 'epoch': 12, 'batch': 0}
{'valid_loss': 8148989953.801, 'loss_diff': 0.0, 'epoch': 12, 'batch': 1}
{'valid_loss': 9486102529.808, 'loss_diff': 0.0, 'epoch': 12, 'batch': 2}
Training VAE model...
{'epoch': 13, 'batch': 0, 'train_loss': 1.739, 'train_elbo_loss': 7.801764112507431e+26, 'train_null_loss': 1.739, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 1, 'train_loss': 1.803, 'train_elbo_loss': 1.150767755002521e+26, 'train_null_loss': 1.803, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 13, 'batch': 2, 'train_loss': 1.805, 'train_elbo_loss': 3.3164888350637154e+26, 'train_null_loss': 1.805, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 721844240385.771, 'loss_diff': 0.0, 'epoch': 13, 'batch': 0}
{'valid_loss': 459002740737.775, 'loss_diff': 0.0, 'epoch': 13, 'batch': 1}
{'valid_loss': 518971916289.821, 'loss_diff': 0.0, 'epoch': 13, 'batch': 2}
Training VAE model...
{'epoch': 14, 'batch': 0, 'train_loss': 1.819, 'train_elbo_loss': 6.409414200000515e+27, 'train_null_loss': 1.819, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 1, 'train_loss': 1.796, 'train_elbo_loss': 1.4332403526158546e+28, 'train_null_loss': 1.796, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 14, 'batch': 2, 'train_loss': 1.82, 'train_elbo_loss': 6.450229849630282e+28, 'train_null_loss': 1.82, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 51764468383745.73, 'loss_diff': 0.0, 'epoch': 14, 'batch': 0}
{'valid_loss': 24383057821697.78, 'loss_diff': 0.0, 'epoch': 14, 'batch': 1}
{'valid_loss': 25008808132609.793, 'loss_diff': 0.0, 'epoch': 14, 'batch': 2}
Training VAE model...
{'epoch': 15, 'batch': 0, 'train_loss': 1.765, 'train_elbo_loss': 5.219805928839037e+28, 'train_null_loss': 1.765, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 15, 'batch': 1, 'train_loss': 1.809, 'train_elbo_loss': 5.624925565698898e+29, 'train_null_loss': 1.809, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 15, 'batch': 2, 'train_loss': 1.78, 'train_elbo_loss': 3.674745746419603e+29, 'train_null_loss': 1.78, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 3822894018723841.5, 'loss_diff': 0.0, 'epoch': 15, 'batch': 0}
{'valid_loss': 1311380753874945.8, 'loss_diff': 0.0, 'epoch': 15, 'batch': 1}
{'valid_loss': 1093923875323905.9, 'loss_diff': 0.0, 'epoch': 15, 'batch': 2}
Training VAE model...
{'epoch': 16, 'batch': 0, 'train_loss': 1.781, 'train_elbo_loss': 1.6431004962811193e+30, 'train_null_loss': 1.781, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 16, 'batch': 1, 'train_loss': 1.866, 'train_elbo_loss': 1.035510609171935e+31, 'train_null_loss': 1.866, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 16, 'batch': 2, 'train_loss': 1.808, 'train_elbo_loss': 8.509459594652629e+29, 'train_null_loss': 1.808, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.7771521387934515e+17, 'loss_diff': 0.0, 'epoch': 16, 'batch': 0}
{'valid_loss': 7.503575013077811e+16, 'loss_diff': 0.0, 'epoch': 16, 'batch': 1}
{'valid_loss': 4.47670926662697e+16, 'loss_diff': 0.0, 'epoch': 16, 'batch': 2}
Training VAE model...
{'epoch': 17, 'batch': 0, 'train_loss': 1.837, 'train_elbo_loss': 3.972714241763417e+31, 'train_null_loss': 1.837, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 17, 'batch': 1, 'train_loss': 1.787, 'train_elbo_loss': 2.1666449778948462e+32, 'train_null_loss': 1.787, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 17, 'batch': 2, 'train_loss': 1.791, 'train_elbo_loss': 1.3080569631105042e+32, 'train_null_loss': 1.791, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.4770646793007923e+19, 'loss_diff': 0.0, 'epoch': 17, 'batch': 0}
{'valid_loss': 3.452379100042232e+18, 'loss_diff': 0.0, 'epoch': 17, 'batch': 1}
{'valid_loss': 1.3628803967562547e+18, 'loss_diff': 0.0, 'epoch': 17, 'batch': 2}
Training VAE model...
{'epoch': 18, 'batch': 0, 'train_loss': 1.789, 'train_elbo_loss': 3.749699488757254e+32, 'train_null_loss': 1.789, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 18, 'batch': 1, 'train_loss': 1.845, 'train_elbo_loss': 1.2191806054150594e+33, 'train_null_loss': 1.845, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 18, 'batch': 2, 'train_loss': 1.813, 'train_elbo_loss': 1.9508333434211768e+32, 'train_null_loss': 1.813, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 5.495384448372352e+20, 'loss_diff': 0.0, 'epoch': 18, 'batch': 0}
{'valid_loss': 1.1932476328718107e+20, 'loss_diff': 0.0, 'epoch': 18, 'batch': 1}
{'valid_loss': 3.0929081769431925e+19, 'loss_diff': 0.0, 'epoch': 18, 'batch': 2}
Training VAE model...
{'epoch': 19, 'batch': 0, 'train_loss': 1.706, 'train_elbo_loss': 1.1322579685581775e+32, 'train_null_loss': 1.706, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 19, 'batch': 1, 'train_loss': 1.794, 'train_elbo_loss': 4.846668235642421e+31, 'train_null_loss': 1.794, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 19, 'batch': 2, 'train_loss': 1.799, 'train_elbo_loss': 7.466970461186968e+31, 'train_null_loss': 1.799, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.1703404146556e+22, 'loss_diff': 0.0, 'epoch': 19, 'batch': 0}
{'valid_loss': 2.4255081549125554e+21, 'loss_diff': 0.0, 'epoch': 19, 'batch': 1}
{'valid_loss': 4.409839608940735e+20, 'loss_diff': 0.0, 'epoch': 19, 'batch': 2}
