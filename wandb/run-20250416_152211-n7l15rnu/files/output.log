Running training on CPU
Loading dataset train
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Loading dataset validation
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Building models...
Completed model building. Took 0.11 s.
                                                                                                                                                               
Preparation complete. Starting training...
Training VAE model...
{'epoch': 0, 'batch': 0, 'train_loss': 1.948, 'train_elbo_loss': 0.501, 'train_null_loss': 1.948, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.716, 'train_elbo_loss': 0.457, 'train_null_loss': 1.716, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.944, 'train_elbo_loss': 0.415, 'train_null_loss': 1.944, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 3, 'train_loss': 1.766, 'train_elbo_loss': 0.381, 'train_null_loss': 1.766, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 4, 'train_loss': 1.778, 'train_elbo_loss': 0.34, 'train_null_loss': 1.778, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 5, 'train_loss': 1.809, 'train_elbo_loss': 0.308, 'train_null_loss': 1.809, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 6, 'train_loss': 1.858, 'train_elbo_loss': 0.275, 'train_null_loss': 1.858, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 7, 'train_loss': 1.762, 'train_elbo_loss': 0.245, 'train_null_loss': 1.762, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 8, 'train_loss': 1.704, 'train_elbo_loss': 0.225, 'train_null_loss': 1.704, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 9, 'train_loss': 1.572, 'train_elbo_loss': 0.206, 'train_null_loss': 1.572, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 10, 'train_loss': 1.948, 'train_elbo_loss': 0.181, 'train_null_loss': 1.948, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 11, 'train_loss': 1.816, 'train_elbo_loss': 0.164, 'train_null_loss': 1.816, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 12, 'train_loss': 1.95, 'train_elbo_loss': 0.146, 'train_null_loss': 1.95, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 13, 'train_loss': 1.744, 'train_elbo_loss': 0.127, 'train_null_loss': 1.744, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 14, 'train_loss': 1.79, 'train_elbo_loss': 0.108, 'train_null_loss': 1.79, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 15, 'train_loss': 1.782, 'train_elbo_loss': 0.099, 'train_null_loss': 1.782, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 16, 'train_loss': 1.855, 'train_elbo_loss': 0.089, 'train_null_loss': 1.855, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 17, 'train_loss': 1.925, 'train_elbo_loss': 0.077, 'train_null_loss': 1.925, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 18, 'train_loss': 1.832, 'train_elbo_loss': 0.069, 'train_null_loss': 1.832, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 19, 'train_loss': 1.948, 'train_elbo_loss': 0.059, 'train_null_loss': 1.948, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 20, 'train_loss': 1.614, 'train_elbo_loss': 0.055, 'train_null_loss': 1.614, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 21, 'train_loss': 1.807, 'train_elbo_loss': 0.051, 'train_null_loss': 1.807, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 22, 'train_loss': 1.868, 'train_elbo_loss': 0.047, 'train_null_loss': 1.868, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 23, 'train_loss': 1.915, 'train_elbo_loss': 0.043, 'train_null_loss': 1.915, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 24, 'train_loss': 1.602, 'train_elbo_loss': 0.042, 'train_null_loss': 1.602, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 25, 'train_loss': 1.753, 'train_elbo_loss': 0.043, 'train_null_loss': 1.753, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 26, 'train_loss': 1.739, 'train_elbo_loss': 0.039, 'train_null_loss': 1.739, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 27, 'train_loss': 1.847, 'train_elbo_loss': 0.035, 'train_null_loss': 1.847, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 28, 'train_loss': 1.835, 'train_elbo_loss': 0.033, 'train_null_loss': 1.835, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 29, 'train_loss': 1.763, 'train_elbo_loss': 0.034, 'train_null_loss': 1.763, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 30, 'train_loss': 1.755, 'train_elbo_loss': 0.033, 'train_null_loss': 1.755, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 31, 'train_loss': 1.921, 'train_elbo_loss': 0.032, 'train_null_loss': 1.921, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 32, 'train_loss': 1.81, 'train_elbo_loss': 0.031, 'train_null_loss': 1.81, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 33, 'train_loss': 1.771, 'train_elbo_loss': 0.031, 'train_null_loss': 1.771, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 34, 'train_loss': 1.768, 'train_elbo_loss': 0.028, 'train_null_loss': 1.768, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 35, 'train_loss': 1.791, 'train_elbo_loss': 0.025, 'train_null_loss': 1.791, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 36, 'train_loss': 1.923, 'train_elbo_loss': 0.023, 'train_null_loss': 1.923, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 37, 'train_loss': 1.91, 'train_elbo_loss': 0.026, 'train_null_loss': 1.91, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 38, 'train_loss': 1.716, 'train_elbo_loss': 0.021, 'train_null_loss': 1.716, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 39, 'train_loss': 1.858, 'train_elbo_loss': 0.026, 'train_null_loss': 1.858, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 40, 'train_loss': 1.751, 'train_elbo_loss': 0.024, 'train_null_loss': 1.751, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 41, 'train_loss': 1.944, 'train_elbo_loss': 0.024, 'train_null_loss': 1.944, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 42, 'train_loss': 1.881, 'train_elbo_loss': 0.022, 'train_null_loss': 1.881, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 43, 'train_loss': 1.781, 'train_elbo_loss': 0.024, 'train_null_loss': 1.781, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 44, 'train_loss': 1.946, 'train_elbo_loss': 0.025, 'train_null_loss': 1.946, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 45, 'train_loss': 1.915, 'train_elbo_loss': 0.025, 'train_null_loss': 1.915, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 46, 'train_loss': 1.75, 'train_elbo_loss': 0.021, 'train_null_loss': 1.75, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 47, 'train_loss': 1.915, 'train_elbo_loss': 0.02, 'train_null_loss': 1.915, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 48, 'train_loss': 1.776, 'train_elbo_loss': 0.02, 'train_null_loss': 1.776, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 49, 'train_loss': 1.823, 'train_elbo_loss': 0.023, 'train_null_loss': 1.823, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 50, 'train_loss': 1.948, 'train_elbo_loss': 0.022, 'train_null_loss': 1.948, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 51, 'train_loss': 1.635, 'train_elbo_loss': 0.023, 'train_null_loss': 1.635, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 52, 'train_loss': 1.787, 'train_elbo_loss': 0.024, 'train_null_loss': 1.787, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 53, 'train_loss': 1.629, 'train_elbo_loss': 0.023, 'train_null_loss': 1.629, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 54, 'train_loss': 1.775, 'train_elbo_loss': 0.018, 'train_null_loss': 1.775, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 55, 'train_loss': 1.945, 'train_elbo_loss': 0.018, 'train_null_loss': 1.945, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 56, 'train_loss': 1.915, 'train_elbo_loss': 0.019, 'train_null_loss': 1.915, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 57, 'train_loss': 1.718, 'train_elbo_loss': 0.015, 'train_null_loss': 1.718, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 58, 'train_loss': 1.924, 'train_elbo_loss': 0.016, 'train_null_loss': 1.924, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 59, 'train_loss': 1.918, 'train_elbo_loss': 0.017, 'train_null_loss': 1.918, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.798, 'loss_diff': 0.0, 'epoch': 0, 'batch': 0}
{'valid_loss': 1.788, 'loss_diff': 0.0, 'epoch': 0, 'batch': 1}
{'valid_loss': 1.793, 'loss_diff': 0.0, 'epoch': 0, 'batch': 2}
{'valid_loss': 1.786, 'loss_diff': 0.0, 'epoch': 0, 'batch': 3}
{'valid_loss': 1.788, 'loss_diff': 0.0, 'epoch': 0, 'batch': 4}
{'valid_loss': 1.786, 'loss_diff': 0.0, 'epoch': 0, 'batch': 5}
{'valid_loss': 1.781, 'loss_diff': 0.0, 'epoch': 0, 'batch': 6}
{'valid_loss': 1.782, 'loss_diff': 0.0, 'epoch': 0, 'batch': 7}
{'valid_loss': 1.785, 'loss_diff': 0.0, 'epoch': 0, 'batch': 8}
{'valid_loss': 1.787, 'loss_diff': 0.0, 'epoch': 0, 'batch': 9}
{'valid_loss': 1.74, 'loss_diff': 0.0, 'epoch': 0, 'batch': 10}
{'valid_loss': 1.741, 'loss_diff': 0.0, 'epoch': 0, 'batch': 11}
{'valid_loss': 1.73, 'loss_diff': 0.0, 'epoch': 0, 'batch': 12}
{'valid_loss': 1.731, 'loss_diff': 0.0, 'epoch': 0, 'batch': 13}
{'valid_loss': 1.721, 'loss_diff': 0.0, 'epoch': 0, 'batch': 14}
{'valid_loss': 1.705, 'loss_diff': 0.0, 'epoch': 0, 'batch': 15}
{'valid_loss': 1.738, 'loss_diff': 0.0, 'epoch': 0, 'batch': 16}
{'valid_loss': 1.753, 'loss_diff': 0.0, 'epoch': 0, 'batch': 17}
{'valid_loss': 1.726, 'loss_diff': 0.0, 'epoch': 0, 'batch': 18}
{'valid_loss': 1.747, 'loss_diff': 0.0, 'epoch': 0, 'batch': 19}
{'valid_loss': 1.852, 'loss_diff': 0.0, 'epoch': 0, 'batch': 20}
{'valid_loss': 1.852, 'loss_diff': 0.0, 'epoch': 0, 'batch': 21}
{'valid_loss': 1.848, 'loss_diff': 0.0, 'epoch': 0, 'batch': 22}
{'valid_loss': 1.864, 'loss_diff': 0.0, 'epoch': 0, 'batch': 23}
{'valid_loss': 1.846, 'loss_diff': 0.0, 'epoch': 0, 'batch': 24}
{'valid_loss': 1.856, 'loss_diff': 0.0, 'epoch': 0, 'batch': 25}
{'valid_loss': 1.848, 'loss_diff': 0.0, 'epoch': 0, 'batch': 26}
{'valid_loss': 1.847, 'loss_diff': 0.0, 'epoch': 0, 'batch': 27}
{'valid_loss': 1.847, 'loss_diff': 0.0, 'epoch': 0, 'batch': 28}
{'valid_loss': 1.859, 'loss_diff': 0.0, 'epoch': 0, 'batch': 29}
{'valid_loss': 1.811, 'loss_diff': 0.0, 'epoch': 0, 'batch': 30}
{'valid_loss': 1.817, 'loss_diff': 0.0, 'epoch': 0, 'batch': 31}
{'valid_loss': 1.825, 'loss_diff': 0.0, 'epoch': 0, 'batch': 32}
{'valid_loss': 1.813, 'loss_diff': 0.0, 'epoch': 0, 'batch': 33}
{'valid_loss': 1.822, 'loss_diff': 0.0, 'epoch': 0, 'batch': 34}
{'valid_loss': 1.826, 'loss_diff': 0.0, 'epoch': 0, 'batch': 35}
{'valid_loss': 1.822, 'loss_diff': 0.0, 'epoch': 0, 'batch': 36}
{'valid_loss': 1.806, 'loss_diff': 0.0, 'epoch': 0, 'batch': 37}
{'valid_loss': 1.814, 'loss_diff': 0.0, 'epoch': 0, 'batch': 38}
{'valid_loss': 1.828, 'loss_diff': 0.0, 'epoch': 0, 'batch': 39}
{'valid_loss': 1.842, 'loss_diff': 0.0, 'epoch': 0, 'batch': 40}
{'valid_loss': 1.841, 'loss_diff': 0.0, 'epoch': 0, 'batch': 41}
{'valid_loss': 1.85, 'loss_diff': 0.0, 'epoch': 0, 'batch': 42}
{'valid_loss': 1.855, 'loss_diff': 0.0, 'epoch': 0, 'batch': 43}
{'valid_loss': 1.834, 'loss_diff': 0.0, 'epoch': 0, 'batch': 44}
{'valid_loss': 1.824, 'loss_diff': 0.0, 'epoch': 0, 'batch': 45}
{'valid_loss': 1.851, 'loss_diff': 0.0, 'epoch': 0, 'batch': 46}
{'valid_loss': 1.834, 'loss_diff': 0.0, 'epoch': 0, 'batch': 47}
{'valid_loss': 1.841, 'loss_diff': 0.0, 'epoch': 0, 'batch': 48}
{'valid_loss': 1.844, 'loss_diff': 0.0, 'epoch': 0, 'batch': 49}
{'valid_loss': 1.843, 'loss_diff': 0.0, 'epoch': 0, 'batch': 50}
{'valid_loss': 1.82, 'loss_diff': 0.0, 'epoch': 0, 'batch': 51}
{'valid_loss': 1.809, 'loss_diff': 0.0, 'epoch': 0, 'batch': 52}
{'valid_loss': 1.814, 'loss_diff': 0.0, 'epoch': 0, 'batch': 53}
{'valid_loss': 1.828, 'loss_diff': 0.0, 'epoch': 0, 'batch': 54}
{'valid_loss': 1.827, 'loss_diff': 0.0, 'epoch': 0, 'batch': 55}
{'valid_loss': 1.819, 'loss_diff': 0.0, 'epoch': 0, 'batch': 56}
{'valid_loss': 1.796, 'loss_diff': 0.0, 'epoch': 0, 'batch': 57}
{'valid_loss': 1.824, 'loss_diff': 0.0, 'epoch': 0, 'batch': 58}
{'valid_loss': 1.818, 'loss_diff': 0.0, 'epoch': 0, 'batch': 59}
