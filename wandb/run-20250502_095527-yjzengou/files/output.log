Running training on CPU
Loading dataset train
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Loading dataset validation
Found pregenerated data dir. Using pregenerated data.
Loading complete. Took 0.00 s.
Building models...
Completed model building. Took 0.11 s.
                                                                                                                                                               
Preparation complete. Starting training...
Training model...
{'epoch': 0, 'batch': 0, 'train_loss': 1.79, 'train_elbo_loss': 0.503, 'train_null_loss': 1.79, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 1, 'train_loss': 1.784, 'train_elbo_loss': 0.446, 'train_null_loss': 1.784, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 2, 'train_loss': 1.842, 'train_elbo_loss': 0.395, 'train_null_loss': 1.842, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 3, 'train_loss': 1.746, 'train_elbo_loss': 0.354, 'train_null_loss': 1.746, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 4, 'train_loss': 1.789, 'train_elbo_loss': 0.32, 'train_null_loss': 1.789, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 5, 'train_loss': 1.839, 'train_elbo_loss': 0.287, 'train_null_loss': 1.839, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 0, 'batch': 6, 'train_loss': 1.724, 'train_elbo_loss': 0.253, 'train_null_loss': 1.724, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.246, 'loss_diff': 0.0, 'epoch': 0, 'batch': 0}
{'valid_loss': 2.287, 'loss_diff': 0.0, 'epoch': 0, 'batch': 1}
{'valid_loss': 2.268, 'loss_diff': 0.0, 'epoch': 0, 'batch': 2}
{'valid_loss': 2.24, 'loss_diff': 0.0, 'epoch': 0, 'batch': 3}
{'valid_loss': 2.246, 'loss_diff': 0.0, 'epoch': 0, 'batch': 4}
{'valid_loss': 2.29, 'loss_diff': 0.0, 'epoch': 0, 'batch': 5}
{'valid_loss': 2.227, 'loss_diff': 0.0, 'epoch': 0, 'batch': 6}
Training model...
{'epoch': 1, 'batch': 0, 'train_loss': 1.802, 'train_elbo_loss': 0.229, 'train_null_loss': 1.802, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 1, 'train_loss': 1.757, 'train_elbo_loss': 0.205, 'train_null_loss': 1.757, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 2, 'train_loss': 1.764, 'train_elbo_loss': 0.187, 'train_null_loss': 1.764, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 3, 'train_loss': 1.787, 'train_elbo_loss': 0.158, 'train_null_loss': 1.787, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 4, 'train_loss': 1.811, 'train_elbo_loss': 0.139, 'train_null_loss': 1.811, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 5, 'train_loss': 1.804, 'train_elbo_loss': 0.125, 'train_null_loss': 1.804, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 1, 'batch': 6, 'train_loss': 1.807, 'train_elbo_loss': 0.109, 'train_null_loss': 1.807, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.263, 'loss_diff': 0.0, 'epoch': 1, 'batch': 0}
{'valid_loss': 2.229, 'loss_diff': 0.0, 'epoch': 1, 'batch': 1}
{'valid_loss': 2.24, 'loss_diff': 0.0, 'epoch': 1, 'batch': 2}
{'valid_loss': 2.243, 'loss_diff': 0.0, 'epoch': 1, 'batch': 3}
{'valid_loss': 2.169, 'loss_diff': 0.0, 'epoch': 1, 'batch': 4}
{'valid_loss': 2.236, 'loss_diff': 0.0, 'epoch': 1, 'batch': 5}
{'valid_loss': 2.151, 'loss_diff': 0.0, 'epoch': 1, 'batch': 6}
Training model...
{'epoch': 2, 'batch': 0, 'train_loss': 1.725, 'train_elbo_loss': 0.097, 'train_null_loss': 1.725, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 1, 'train_loss': 1.819, 'train_elbo_loss': 0.081, 'train_null_loss': 1.819, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 2, 'train_loss': 1.84, 'train_elbo_loss': 0.074, 'train_null_loss': 1.84, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 3, 'train_loss': 1.732, 'train_elbo_loss': 0.066, 'train_null_loss': 1.732, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 4, 'train_loss': 1.691, 'train_elbo_loss': 0.061, 'train_null_loss': 1.691, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 5, 'train_loss': 1.697, 'train_elbo_loss': 0.056, 'train_null_loss': 1.697, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 2, 'batch': 6, 'train_loss': 1.8, 'train_elbo_loss': 0.052, 'train_null_loss': 1.8, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 2.036, 'loss_diff': 0.0, 'epoch': 2, 'batch': 0}
{'valid_loss': 2.074, 'loss_diff': 0.0, 'epoch': 2, 'batch': 1}
{'valid_loss': 2.126, 'loss_diff': 0.0, 'epoch': 2, 'batch': 2}
{'valid_loss': 2.143, 'loss_diff': 0.0, 'epoch': 2, 'batch': 3}
{'valid_loss': 2.061, 'loss_diff': 0.0, 'epoch': 2, 'batch': 4}
{'valid_loss': 2.138, 'loss_diff': 0.0, 'epoch': 2, 'batch': 5}
{'valid_loss': 2.055, 'loss_diff': 0.0, 'epoch': 2, 'batch': 6}
Training model...
{'epoch': 3, 'batch': 0, 'train_loss': 1.705, 'train_elbo_loss': 0.048, 'train_null_loss': 1.705, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 1, 'train_loss': 1.744, 'train_elbo_loss': 0.048, 'train_null_loss': 1.744, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 2, 'train_loss': 1.738, 'train_elbo_loss': 0.043, 'train_null_loss': 1.738, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 3, 'train_loss': 1.748, 'train_elbo_loss': 0.041, 'train_null_loss': 1.748, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 4, 'train_loss': 1.683, 'train_elbo_loss': 0.038, 'train_null_loss': 1.683, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 5, 'train_loss': 1.854, 'train_elbo_loss': 0.038, 'train_null_loss': 1.854, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 3, 'batch': 6, 'train_loss': 1.696, 'train_elbo_loss': 0.035, 'train_null_loss': 1.696, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.622, 'loss_diff': 0.0, 'epoch': 3, 'batch': 0}
{'valid_loss': 1.847, 'loss_diff': 0.0, 'epoch': 3, 'batch': 1}
{'valid_loss': 1.992, 'loss_diff': 0.0, 'epoch': 3, 'batch': 2}
{'valid_loss': 2.051, 'loss_diff': 0.0, 'epoch': 3, 'batch': 3}
{'valid_loss': 2.027, 'loss_diff': 0.0, 'epoch': 3, 'batch': 4}
{'valid_loss': 2.017, 'loss_diff': 0.0, 'epoch': 3, 'batch': 5}
{'valid_loss': 1.991, 'loss_diff': 0.0, 'epoch': 3, 'batch': 6}
Training model...
{'epoch': 4, 'batch': 0, 'train_loss': 1.731, 'train_elbo_loss': 0.036, 'train_null_loss': 1.731, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 1, 'train_loss': 1.706, 'train_elbo_loss': 0.034, 'train_null_loss': 1.706, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 2, 'train_loss': 1.799, 'train_elbo_loss': 0.032, 'train_null_loss': 1.799, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 3, 'train_loss': 1.658, 'train_elbo_loss': 0.03, 'train_null_loss': 1.658, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 4, 'train_loss': 1.762, 'train_elbo_loss': 0.03, 'train_null_loss': 1.762, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 5, 'train_loss': 1.761, 'train_elbo_loss': 0.03, 'train_null_loss': 1.761, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 4, 'batch': 6, 'train_loss': 1.87, 'train_elbo_loss': 0.03, 'train_null_loss': 1.87, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.545, 'loss_diff': 0.0, 'epoch': 4, 'batch': 0}
{'valid_loss': 1.781, 'loss_diff': 0.0, 'epoch': 4, 'batch': 1}
{'valid_loss': 1.94, 'loss_diff': 0.0, 'epoch': 4, 'batch': 2}
{'valid_loss': 1.997, 'loss_diff': 0.0, 'epoch': 4, 'batch': 3}
{'valid_loss': 1.973, 'loss_diff': 0.0, 'epoch': 4, 'batch': 4}
{'valid_loss': 1.836, 'loss_diff': 0.0, 'epoch': 4, 'batch': 5}
{'valid_loss': 1.832, 'loss_diff': 0.0, 'epoch': 4, 'batch': 6}
Training model...
{'epoch': 5, 'batch': 0, 'train_loss': 1.705, 'train_elbo_loss': 0.028, 'train_null_loss': 1.705, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 1, 'train_loss': 1.819, 'train_elbo_loss': 0.027, 'train_null_loss': 1.819, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 2, 'train_loss': 1.723, 'train_elbo_loss': 0.026, 'train_null_loss': 1.723, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 3, 'train_loss': 1.686, 'train_elbo_loss': 0.028, 'train_null_loss': 1.686, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 4, 'train_loss': 1.726, 'train_elbo_loss': 0.025, 'train_null_loss': 1.726, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 5, 'train_loss': 1.722, 'train_elbo_loss': 0.025, 'train_null_loss': 1.722, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 5, 'batch': 6, 'train_loss': 1.647, 'train_elbo_loss': 0.027, 'train_null_loss': 1.647, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.791, 'loss_diff': 0.0, 'epoch': 5, 'batch': 0}
{'valid_loss': 1.829, 'loss_diff': 0.0, 'epoch': 5, 'batch': 1}
{'valid_loss': 1.921, 'loss_diff': 0.0, 'epoch': 5, 'batch': 2}
{'valid_loss': 1.949, 'loss_diff': 0.0, 'epoch': 5, 'batch': 3}
{'valid_loss': 1.926, 'loss_diff': 0.0, 'epoch': 5, 'batch': 4}
{'valid_loss': 1.643, 'loss_diff': 0.0, 'epoch': 5, 'batch': 5}
{'valid_loss': 1.627, 'loss_diff': 0.0, 'epoch': 5, 'batch': 6}
Training model...
{'epoch': 6, 'batch': 0, 'train_loss': 1.713, 'train_elbo_loss': 0.023, 'train_null_loss': 1.713, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 1, 'train_loss': 1.698, 'train_elbo_loss': 0.024, 'train_null_loss': 1.698, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 2, 'train_loss': 1.711, 'train_elbo_loss': 0.024, 'train_null_loss': 1.711, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 3, 'train_loss': 1.769, 'train_elbo_loss': 0.024, 'train_null_loss': 1.769, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 4, 'train_loss': 1.618, 'train_elbo_loss': 0.023, 'train_null_loss': 1.618, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 5, 'train_loss': 1.726, 'train_elbo_loss': 0.022, 'train_null_loss': 1.726, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 6, 'batch': 6, 'train_loss': 1.657, 'train_elbo_loss': 0.023, 'train_null_loss': 1.657, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.8, 'loss_diff': 0.0, 'epoch': 6, 'batch': 0}
{'valid_loss': 1.818, 'loss_diff': 0.0, 'epoch': 6, 'batch': 1}
{'valid_loss': 1.905, 'loss_diff': 0.0, 'epoch': 6, 'batch': 2}
{'valid_loss': 1.916, 'loss_diff': 0.0, 'epoch': 6, 'batch': 3}
{'valid_loss': 1.918, 'loss_diff': 0.0, 'epoch': 6, 'batch': 4}
{'valid_loss': 1.641, 'loss_diff': 0.0, 'epoch': 6, 'batch': 5}
{'valid_loss': 1.618, 'loss_diff': 0.0, 'epoch': 6, 'batch': 6}
Training model...
{'epoch': 7, 'batch': 0, 'train_loss': 1.678, 'train_elbo_loss': 0.022, 'train_null_loss': 1.678, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 1, 'train_loss': 1.707, 'train_elbo_loss': 0.023, 'train_null_loss': 1.707, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 2, 'train_loss': 1.669, 'train_elbo_loss': 0.022, 'train_null_loss': 1.669, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 3, 'train_loss': 1.727, 'train_elbo_loss': 0.023, 'train_null_loss': 1.727, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 4, 'train_loss': 1.702, 'train_elbo_loss': 0.022, 'train_null_loss': 1.702, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 5, 'train_loss': 1.724, 'train_elbo_loss': 0.022, 'train_null_loss': 1.724, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 7, 'batch': 6, 'train_loss': 1.753, 'train_elbo_loss': 0.021, 'train_null_loss': 1.753, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.862, 'loss_diff': 0.0, 'epoch': 7, 'batch': 0}
{'valid_loss': 1.835, 'loss_diff': 0.0, 'epoch': 7, 'batch': 1}
{'valid_loss': 1.868, 'loss_diff': 0.0, 'epoch': 7, 'batch': 2}
{'valid_loss': 1.888, 'loss_diff': 0.0, 'epoch': 7, 'batch': 3}
{'valid_loss': 1.934, 'loss_diff': 0.0, 'epoch': 7, 'batch': 4}
{'valid_loss': 1.618, 'loss_diff': 0.0, 'epoch': 7, 'batch': 5}
{'valid_loss': 1.613, 'loss_diff': 0.0, 'epoch': 7, 'batch': 6}
Training model...
{'epoch': 8, 'batch': 0, 'train_loss': 1.663, 'train_elbo_loss': 0.021, 'train_null_loss': 1.663, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 1, 'train_loss': 1.801, 'train_elbo_loss': 0.02, 'train_null_loss': 1.801, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 2, 'train_loss': 1.68, 'train_elbo_loss': 0.022, 'train_null_loss': 1.68, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 3, 'train_loss': 1.694, 'train_elbo_loss': 0.021, 'train_null_loss': 1.694, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 4, 'train_loss': 1.667, 'train_elbo_loss': 0.02, 'train_null_loss': 1.667, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 5, 'train_loss': 1.652, 'train_elbo_loss': 0.02, 'train_null_loss': 1.652, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 8, 'batch': 6, 'train_loss': 1.711, 'train_elbo_loss': 0.019, 'train_null_loss': 1.711, 'train_embed_loss': nan, 'train_loss_diff': nan}
Running validation...
{'valid_loss': 1.78, 'loss_diff': 0.0, 'epoch': 8, 'batch': 0}
{'valid_loss': 1.822, 'loss_diff': 0.0, 'epoch': 8, 'batch': 1}
{'valid_loss': 1.867, 'loss_diff': 0.0, 'epoch': 8, 'batch': 2}
{'valid_loss': 1.877, 'loss_diff': 0.0, 'epoch': 8, 'batch': 3}
{'valid_loss': 1.909, 'loss_diff': 0.0, 'epoch': 8, 'batch': 4}
{'valid_loss': 1.626, 'loss_diff': 0.0, 'epoch': 8, 'batch': 5}
{'valid_loss': 1.661, 'loss_diff': 0.0, 'epoch': 8, 'batch': 6}
Training model...
{'epoch': 9, 'batch': 0, 'train_loss': 1.601, 'train_elbo_loss': 0.019, 'train_null_loss': 1.601, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 1, 'train_loss': 1.742, 'train_elbo_loss': 0.02, 'train_null_loss': 1.742, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 2, 'train_loss': 1.697, 'train_elbo_loss': 0.018, 'train_null_loss': 1.697, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 3, 'train_loss': 1.603, 'train_elbo_loss': 0.02, 'train_null_loss': 1.603, 'train_embed_loss': nan, 'train_loss_diff': nan}
{'epoch': 9, 'batch': 4, 'train_loss': 1.766, 'train_elbo_loss': 0.022, 'train_null_loss': 1.766, 'train_embed_loss': nan, 'train_loss_diff': nan}
